<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Atlas mondial des formes littÃ©raires</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Cinzel+Decorative:wght@400;700&family=EB+Garamond:ital,wght@0,400;0,500;0,600;1,400;1,500&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --bg: #0c1220; --ocean: #152638; --land: #4a4238;
            --land-border: rgba(8,14,26,0.6);
            --highlight: #d4a849; --highlight-hover: #f0cc60;
            --highlight-glow: rgba(212,168,73,0.35);
            --gold: #c9a227; --gold-light: #e8d078; --cream: #e8dcc8;
            --text-dim: #7a6e5f; --text-faint: rgba(122,110,95,0.5);
            --border-subtle: rgba(201,162,39,0.18);
            --border-gold: rgba(201,162,39,0.4);
            --card-bg: rgba(15,25,45,0.7);
            --city-color: #e06040; --city-hover: #ff8866;
        }
        body { background: var(--bg); color: var(--cream); font-family: 'EB Garamond', serif; min-height: 100vh; overflow-x: hidden;
            background-image: radial-gradient(ellipse at 50% 0%, rgba(30,60,100,0.12) 0%, transparent 60%), radial-gradient(ellipse at 80% 100%, rgba(80,50,20,0.06) 0%, transparent 50%); }

        /* â”€â”€ NAV â”€â”€ */
        .site-nav { display: flex; align-items: center; justify-content: space-between; padding: 14px 44px; border-bottom: 1px solid var(--border-subtle); background: rgba(12,18,32,0.97); position: sticky; top: 0; z-index: 200; backdrop-filter: blur(14px); }
        .nav-brand { display: flex; align-items: center; gap: 12px; text-decoration: none; }
        .nav-diamond { color: var(--gold); font-size: 0.52rem; }
        .nav-brand-text { font-family: 'Cinzel', serif; font-size: 0.73rem; letter-spacing: 0.22em; text-transform: uppercase; color: var(--gold-light); }
        .nav-links { display: flex; gap: 36px; }
        .nav-link { font-family: 'Cinzel', serif; font-size: 0.68rem; letter-spacing: 0.18em; text-transform: uppercase; color: var(--text-dim); text-decoration: none; transition: color .22s; padding-bottom: 2px; border-bottom: 1px solid transparent; }
        .nav-link:hover { color: var(--gold-light); border-bottom-color: rgba(201,162,39,.3); }
        .nav-link.active { color: var(--gold-light); border-bottom-color: var(--gold); }
        @media(max-width:640px){ .site-nav { padding: 12px 20px; } .nav-links { gap: 16px; } .nav-link { font-size: .6rem; } }

        header { text-align: center; padding: 40px 20px 6px; }
        .header-ornament { display: flex; align-items: center; justify-content: center; gap: 14px; margin-bottom: 16px; }
        .header-line { flex: 1; max-width: 160px; height: 1px; background: linear-gradient(to right, transparent, var(--gold)); }
        .header-line.right { background: linear-gradient(to left, transparent, var(--gold)); }
        .header-diamond { width: 8px; height: 8px; background: var(--gold); transform: rotate(45deg); opacity: 0.7; }
        .title-main { font-family: 'Cinzel Decorative', serif; font-size: clamp(1.3rem, 3.2vw, 2.4rem); color: var(--gold-light); letter-spacing: 0.03em; text-shadow: 0 0 50px rgba(201,162,39,0.2), 0 2px 8px rgba(0,0,0,0.6); }
        .title-sub { font-family: 'Cinzel', serif; font-size: clamp(0.55rem, 1.1vw, 0.75rem); letter-spacing: 0.35em; text-transform: uppercase; color: var(--text-dim); margin-top: 10px; }

        .section-label { text-align: center; font-family: 'Cinzel', serif; font-size: 0.66rem; letter-spacing: 0.3em; text-transform: uppercase; color: var(--text-faint); padding: 20px 20px 8px; }
        .btn-row { display: flex; justify-content: center; flex-wrap: wrap; gap: 8px; padding: 4px 20px 10px; }
        .lit-btn, .proj-btn { background: transparent; border: 1px solid var(--border-subtle); color: var(--text-dim); font-family: 'Cinzel', serif; font-size: 0.76rem; letter-spacing: 0.18em; text-transform: uppercase; padding: 8px 20px; cursor: pointer; transition: all 0.28s; outline: none; }
        .lit-btn:hover, .proj-btn:hover { color: var(--gold-light); border-color: rgba(201,162,39,0.55); background: rgba(201,162,39,0.05); }
        .lit-btn.active, .proj-btn.active { background: var(--gold); border-color: var(--gold); color: var(--bg); }
        .lit-btn { font-size: 0.82rem; padding: 10px 26px; }
        .thin-divider { max-width: 700px; margin: 6px auto; height: 1px; background: linear-gradient(to right, transparent, rgba(201,162,39,0.12), transparent); }
        .form-desc { text-align: center; font-style: italic; color: var(--text-dim); font-size: 1.02rem; padding: 4px 30px 14px; max-width: 800px; margin: 0 auto; min-height: 28px; line-height: 1.6; }

        /* MAP */
        .map-wrapper { display: flex; justify-content: center; padding: 0 16px; position: relative; }
        #main-map { width: 100%; max-width: 1080px; display: none; cursor: default; overflow: hidden; }
        #main-map.is-globe { cursor: grab; }
        #main-map.is-globe:active { cursor: grabbing; }
        .loading-screen { display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 80px 20px; gap: 16px; }
        .loading-spinner { width: 32px; height: 32px; border: 2px solid rgba(201,162,39,0.15); border-top-color: var(--gold); border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .loading-text { font-family: 'Cinzel', serif; font-size: 0.72rem; letter-spacing: 0.2em; text-transform: uppercase; color: var(--text-dim); }

        .globe-hint { text-align: center; font-family: 'Cinzel', serif; font-size: 0.6rem; letter-spacing: 0.2em; text-transform: uppercase; color: rgba(201,162,39,0.4); padding-bottom: 2px; display: none; }
        .globe-hint.visible { display: block; }
        .proj-info-bar { text-align: center; padding: 8px 24px 2px; font-style: italic; color: var(--text-faint); font-size: 0.82rem; min-height: 28px; }

        /* ZOOM CONTROLS */
        .zoom-controls { position: absolute; right: 24px; top: 12px; display: flex; flex-direction: column; gap: 4px; z-index: 10; }
        .zoom-btn { width: 32px; height: 32px; background: rgba(15,25,45,0.85); border: 1px solid var(--border-subtle); color: var(--text-dim); font-family: 'Cinzel', serif; font-size: 1rem; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.2s; backdrop-filter: blur(8px); }
        .zoom-btn:hover { border-color: var(--border-gold); color: var(--gold-light); background: rgba(201,162,39,0.08); }
        .zoom-btn.reset { font-size: 0.55rem; letter-spacing: 0.05em; }

        /* TIMELINE */
        .timeline-section { max-width: 860px; margin: 10px auto 0; padding: 0 30px; }
        .timeline-year-display { text-align: center; padding-bottom: 10px; }
        .timeline-year { font-family: 'Cinzel Decorative', serif; font-size: 1.45rem; color: var(--gold-light); text-shadow: 0 0 30px rgba(201,162,39,0.2); }
        .timeline-controls { display: flex; align-items: center; gap: 12px; }
        .timeline-arrow { background: transparent; border: 1px solid var(--border-subtle); color: var(--text-dim); font-size: 1rem; width: 36px; height: 36px; cursor: pointer; transition: all 0.2s; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
        .timeline-arrow:hover { border-color: var(--border-gold); color: var(--gold-light); background: rgba(201,162,39,0.06); }
        .timeline-arrow:disabled { opacity: 0.25; cursor: default; }
        .timeline-track-wrapper { flex: 1; position: relative; height: 44px; }
        .timeline-track { position: absolute; top: 14px; left: 0; right: 0; height: 2px; background: rgba(201,162,39,0.15); }
        .timeline-track-fill { position: absolute; top: 14px; left: 0; height: 2px; background: linear-gradient(to right, var(--gold), var(--highlight)); transition: width 0.3s; }
        .timeline-marker { position: absolute; top: 8px; width: 12px; height: 12px; border-radius: 50%; border: 2px solid rgba(201,162,39,0.3); background: var(--bg); transform: translateX(-6px); cursor: pointer; transition: all 0.25s; z-index: 2; }
        .timeline-marker:hover { border-color: var(--gold); background: rgba(201,162,39,0.15); transform: translateX(-6px) scale(1.3); }
        .timeline-marker.active { background: var(--gold); border-color: var(--gold-light); box-shadow: 0 0 12px var(--highlight-glow); transform: translateX(-6px) scale(1.2); }
        .timeline-marker-year { position: absolute; top: 28px; left: 50%; transform: translateX(-50%); font-family: 'Cinzel', serif; font-size: 0.55rem; letter-spacing: 0.05em; color: var(--text-faint); white-space: nowrap; }
        .timeline-marker.active .timeline-marker-year { color: var(--gold); }

        /* EVENT CARD */
        .event-card { max-width: 860px; margin: 14px auto 0; padding: 0 30px 20px; }
        .event-card-inner { background: var(--card-bg); border: 1px solid var(--border-subtle); padding: 18px 24px; position: relative; overflow: hidden; }
        .event-card-inner::before { content: ''; position: absolute; inset: 0; background: linear-gradient(135deg, rgba(201,162,39,0.03) 0%, transparent 60%); pointer-events: none; }
        .event-entries { display: flex; flex-direction: column; gap: 12px; }
        .event-entry { display: flex; gap: 14px; align-items: flex-start; }
        .event-flag { font-size: 1.6rem; line-height: 1; flex-shrink: 0; margin-top: 2px; }
        .event-title { font-family: 'Cinzel', serif; font-size: 0.88rem; font-weight: 600; color: var(--gold-light); letter-spacing: 0.06em; margin-bottom: 4px; }
        .event-detail { font-size: 1.02rem; color: var(--cream); line-height: 1.6; opacity: 0.88; }
        .event-city-tag { font-family: 'Cinzel', serif; font-size: 0.68rem; letter-spacing: 0.1em; color: var(--city-color); margin-left: 4px; }

        /* DIVIDER + GALLERY */
        .ornament-divider { display: flex; align-items: center; gap: 16px; padding: 20px 40px; max-width: 900px; margin: 0 auto; }
        .divider-line { flex: 1; height: 1px; background: linear-gradient(to right, transparent, rgba(201,162,39,0.2), transparent); }
        .divider-text { font-family: 'Cinzel', serif; font-size: 0.62rem; letter-spacing: 0.28em; text-transform: uppercase; color: var(--text-dim); white-space: nowrap; }
        .gallery-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 14px; max-width: 1100px; margin: 0 auto; padding: 0 20px 50px; }
        @media (max-width: 900px) { .gallery-grid { grid-template-columns: repeat(2, 1fr); } }
        @media (max-width: 500px) { .gallery-grid { grid-template-columns: 1fr; } }
        .gallery-card { background: var(--card-bg); border: 1px solid var(--border-subtle); padding: 12px; cursor: pointer; transition: border-color 0.28s, transform 0.28s, box-shadow 0.28s; position: relative; overflow: hidden; }
        .gallery-card::before { content: ''; position: absolute; inset: 0; background: linear-gradient(135deg, rgba(201,162,39,0.04) 0%, transparent 60%); pointer-events: none; }
        .gallery-card:hover { border-color: rgba(201,162,39,0.5); transform: translateY(-2px); box-shadow: 0 8px 30px rgba(0,0,0,0.4); }
        .gallery-card.active { border-color: rgba(201,162,39,0.75); }
        .gallery-card.active::after { content: 'â–¸ ACTIVE'; position: absolute; top: 7px; right: 9px; font-family: 'Cinzel', serif; font-size: 0.5rem; letter-spacing: 0.15em; color: var(--gold); }
        .gallery-label { font-family: 'Cinzel', serif; font-size: 0.72rem; letter-spacing: 0.18em; text-transform: uppercase; color: var(--gold); margin-bottom: 8px; }
        .gallery-card svg { width: 100%; display: block; }

        /* SVG */
        .sphere-fill { fill: var(--ocean); }
        .graticule { fill: none; stroke: rgba(100,155,200,0.08); stroke-width: 0.4; }
        .country { fill: var(--land); stroke: var(--land-border); stroke-width: 0.4; transition: fill 0.15s; }
        .country:hover { fill: #5a5248; }
        .country.lit-active { fill: var(--highlight); stroke: rgba(180,140,40,0.6); stroke-width: 0.6; }
        .country.lit-active:hover { fill: var(--highlight-hover); }
        .sphere-border { fill: none; stroke: rgba(201,162,39,0.3); stroke-width: 0.8; }
        .gallery-card .country { transition: none; pointer-events: none; }

        /* CITY DOTS */
        .city-dot { fill: var(--city-color); stroke: rgba(0,0,0,0.5); stroke-width: 0.8; cursor: pointer; transition: r 0.15s, fill 0.15s; filter: drop-shadow(0 0 3px rgba(224,96,64,0.4)); }
        .city-dot:hover { fill: var(--city-hover); }
        .city-label { font-family: 'Cinzel', serif; font-size: 9px; fill: var(--cream); pointer-events: none; text-anchor: middle; dominant-baseline: text-before-edge; opacity: 0.9; }

        /* TOOLTIP */
        #tooltip { position: fixed; pointer-events: none; background: rgba(10,16,30,0.97); border: 1px solid rgba(201,162,39,0.38); padding: 14px 18px 16px; min-width: 240px; max-width: 340px; opacity: 0; transform: translateY(6px) scale(0.98); transition: opacity 0.18s, transform 0.18s; z-index: 9999; backdrop-filter: blur(12px); box-shadow: 0 12px 40px rgba(0,0,0,0.6), 0 0 0 1px rgba(201,162,39,0.08); }
        #tooltip.visible { opacity: 1; transform: translateY(0) scale(1); }
        .tip-header { display: flex; align-items: center; gap: 12px; margin-bottom: 10px; padding-bottom: 9px; border-bottom: 1px solid rgba(201,162,39,0.25); }
        .tip-flag { font-size: 2rem; line-height: 1; flex-shrink: 0; }
        .tip-name { font-family: 'Cinzel', serif; font-size: 0.95rem; font-weight: 600; color: var(--gold-light); line-height: 1.25; }
        .tip-subtitle { font-style: italic; font-size: 0.78rem; color: var(--text-dim); margin-top: 2px; }
        .tip-rows { display: grid; grid-template-columns: auto 1fr; gap: 4px 12px; }
        .tip-lbl { font-family: 'Cinzel', serif; font-size: 0.65rem; letter-spacing: 0.1em; text-transform: uppercase; color: var(--text-dim); align-self: center; }
        .tip-val { font-size: 0.95rem; color: var(--cream); }
        .tip-lit-section { margin-top: 10px; padding-top: 9px; border-top: 1px solid rgba(201,162,39,0.18); }
        .tip-lit-label { font-family: 'Cinzel', serif; font-size: 0.62rem; letter-spacing: 0.18em; text-transform: uppercase; color: var(--gold); margin-bottom: 6px; }
        .tip-lit-event { margin-bottom: 6px; }
        .tip-lit-event:last-child { margin-bottom: 0; }
        .tip-lit-year { font-family: 'Cinzel', serif; font-size: 0.78rem; color: var(--gold-light); }
        .tip-lit-text { font-size: 0.9rem; color: var(--cream); opacity: 0.85; line-height: 1.4; }
        .tip-city-badge { display: inline-block; font-family: 'Cinzel', serif; font-size: 0.62rem; letter-spacing: 0.08em; color: var(--city-color); border: 1px solid rgba(224,96,64,0.3); padding: 1px 6px; margin-left: 6px; }
        .tip-inherited { opacity: 0.6; border-left: 2px solid rgba(201,162,39,0.2); padding-left: 8px; margin-left: 4px; }
        .tip-inherited-label { font-family: 'Cinzel', serif; font-size: 0.58rem; letter-spacing: 0.12em; text-transform: uppercase; color: var(--text-faint); margin-bottom: 4px; }

        footer { text-align: center; padding: 16px 20px 24px; font-family: 'Cinzel', serif; font-size: 0.55rem; letter-spacing: 0.22em; text-transform: uppercase; color: rgba(122,110,95,0.35); }
    </style>
</head>
<body>

<nav class="site-nav">
  <a class="nav-brand" href="index.html"><span class="nav-diamond">â—†</span><span class="nav-brand-text">Atlas Â· Formes LittÃ©raires</span></a>
  <div class="nav-links">
    <a href="index.html" class="nav-link">Accueil</a>
    <a href="atlas.html" class="nav-link active">Atlas</a>
    <a href="trees.html" class="nav-link">Arborescences</a>
    <a href="contact.html" class="nav-link">Contact</a>
  </div>
</nav>

<header>
    <div class="header-ornament">
        <div class="header-line"></div>
        <div class="header-diamond"></div>
        <div class="header-diamond" style="opacity:.4;transform:rotate(45deg) scale(.65);"></div>
        <div class="header-diamond"></div>
        <div class="header-line right"></div>
    </div>
    <div class="title-main">Atlas mondial des formes littÃ©raires</div>
    <div class="title-sub">Circulation et diffusion des formes Ã  travers le monde</div>
</header>

<div class="section-label">Forme littÃ©raire</div>
<div class="btn-row" id="lit-nav"></div>
<p class="form-desc" id="form-desc"></p>
<div class="thin-divider"></div>

<div class="section-label">Projection cartographique</div>
<div class="btn-row" id="proj-nav"></div>

<div class="map-wrapper">
    <div class="loading-screen" id="loading">
        <div class="loading-spinner"></div>
        <div class="loading-text">Chargement des donnÃ©es cartographiquesâ€¦</div>
    </div>
    <svg id="main-map" viewBox="0 0 960 520" preserveAspectRatio="xMidYMid meet"></svg>
    <div class="zoom-controls" id="zoom-controls" style="display:none;">
        <button class="zoom-btn" id="z-in" title="Zoom +">+</button>
        <button class="zoom-btn" id="z-out" title="Zoom âˆ’">âˆ’</button>
        <button class="zoom-btn reset" id="z-reset" title="RÃ©initialiser">âŸ³</button>
    </div>
</div>
<p class="globe-hint" id="globe-hint">Cliquez et faites glisser pour faire pivoter le globe</p>
<p class="proj-info-bar" id="proj-info"></p>

<div class="timeline-section" id="timeline-section">
    <div class="timeline-year-display"><div class="timeline-year" id="timeline-year"></div></div>
    <div class="timeline-controls">
        <button class="timeline-arrow" id="tl-prev" title="Date prÃ©cÃ©dente">&#9666;</button>
        <div class="timeline-track-wrapper" id="tl-track-wrapper">
            <div class="timeline-track"></div>
            <div class="timeline-track-fill" id="tl-fill"></div>
        </div>
        <button class="timeline-arrow" id="tl-next" title="Date suivante">&#9656;</button>
    </div>
</div>

<div class="event-card" id="event-card"><div class="event-card-inner" id="event-card-inner"></div></div>

<div class="ornament-divider"><div class="divider-line"></div><span class="divider-text">Comparaison des projections</span><div class="divider-line"></div></div>
<div class="gallery-grid" id="gallery"></div>

<div id="tooltip">
    <div class="tip-header"><span class="tip-flag" id="t-flag"></span><div><div class="tip-name" id="t-name"></div><div class="tip-subtitle" id="t-sub"></div></div></div>
    <div id="tip-body"></div>
</div>

<footer>Sources : Natural Earth / World Atlas Â· D3.js Â· TopoJSON</footer>

<script src="https://cdn.jsdelivr.net/npm/d3@7/dist/d3.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/topojson-client@3/dist/topojson-client.min.js"></script>
<script>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PAYS (extrait â€” dictionnaire pays modernes)
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const PAYS={
"004":{nom:"Afghanistan",capitale:"Kaboul",pop:"40,1 M",superficie:"652 230 kmÂ²",continent:"Asie",drapeau:"ðŸ‡¦ðŸ‡«"},
"008":{nom:"Albanie",capitale:"Tirana",pop:"2,8 M",superficie:"28 748 kmÂ²",continent:"Europe",drapeau:"ðŸ‡¦ðŸ‡±"},
"012":{nom:"AlgÃ©rie",capitale:"Alger",pop:"44,7 M",superficie:"2 381 741 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡©ðŸ‡¿"},
"032":{nom:"Argentine",capitale:"Buenos Aires",pop:"45,2 M",superficie:"2 780 400 kmÂ²",continent:"AmÃ©rique du Sud",drapeau:"ðŸ‡¦ðŸ‡·"},
"036":{nom:"Australie",capitale:"Canberra",pop:"25,7 M",superficie:"7 692 024 kmÂ²",continent:"OcÃ©anie",drapeau:"ðŸ‡¦ðŸ‡º"},
"040":{nom:"Autriche",capitale:"Vienne",pop:"9,1 M",superficie:"83 871 kmÂ²",continent:"Europe",drapeau:"ðŸ‡¦ðŸ‡¹"},
"056":{nom:"Belgique",capitale:"Bruxelles",pop:"11,6 M",superficie:"30 528 kmÂ²",continent:"Europe",drapeau:"ðŸ‡§ðŸ‡ª"},
"076":{nom:"BrÃ©sil",capitale:"BrasÃ­lia",pop:"214 M",superficie:"8 515 767 kmÂ²",continent:"AmÃ©rique du Sud",drapeau:"ðŸ‡§ðŸ‡·"},
"100":{nom:"Bulgarie",capitale:"Sofia",pop:"6,5 M",superficie:"110 879 kmÂ²",continent:"Europe",drapeau:"ðŸ‡§ðŸ‡¬"},
"124":{nom:"Canada",capitale:"Ottawa",pop:"38,2 M",superficie:"9 984 670 kmÂ²",continent:"AmÃ©rique du Nord",drapeau:"ðŸ‡¨ðŸ‡¦"},
"152":{nom:"Chili",capitale:"Santiago",pop:"19,1 M",superficie:"756 102 kmÂ²",continent:"AmÃ©rique du Sud",drapeau:"ðŸ‡¨ðŸ‡±"},
"156":{nom:"Chine",capitale:"PÃ©kin",pop:"1 412 M",superficie:"9 596 960 kmÂ²",continent:"Asie",drapeau:"ðŸ‡¨ðŸ‡³"},
"170":{nom:"Colombie",capitale:"BogotÃ¡",pop:"51 M",superficie:"1 141 748 kmÂ²",continent:"AmÃ©rique du Sud",drapeau:"ðŸ‡¨ðŸ‡´"},
"191":{nom:"Croatie",capitale:"Zagreb",pop:"4 M",superficie:"56 594 kmÂ²",continent:"Europe",drapeau:"ðŸ‡­ðŸ‡·"},
"203":{nom:"TchÃ©quie",capitale:"Prague",pop:"10,7 M",superficie:"78 866 kmÂ²",continent:"Europe",drapeau:"ðŸ‡¨ðŸ‡¿"},
"208":{nom:"Danemark",capitale:"Copenhague",pop:"5,9 M",superficie:"43 094 kmÂ²",continent:"Europe",drapeau:"ðŸ‡©ðŸ‡°"},
"818":{nom:"Ã‰gypte",capitale:"Le Caire",pop:"102,3 M",superficie:"1 001 450 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡ªðŸ‡¬"},
"233":{nom:"Estonie",capitale:"Tallinn",pop:"1,3 M",superficie:"45 227 kmÂ²",continent:"Europe",drapeau:"ðŸ‡ªðŸ‡ª"},
"246":{nom:"Finlande",capitale:"Helsinki",pop:"5,5 M",superficie:"338 455 kmÂ²",continent:"Europe",drapeau:"ðŸ‡«ðŸ‡®"},
"250":{nom:"France",capitale:"Paris",pop:"68,4 M",superficie:"551 695 kmÂ²",continent:"Europe",drapeau:"ðŸ‡«ðŸ‡·"},
"276":{nom:"Allemagne",capitale:"Berlin",pop:"83,8 M",superficie:"357 114 kmÂ²",continent:"Europe",drapeau:"ðŸ‡©ðŸ‡ª"},
"300":{nom:"GrÃ¨ce",capitale:"AthÃ¨nes",pop:"10,7 M",superficie:"131 957 kmÂ²",continent:"Europe",drapeau:"ðŸ‡¬ðŸ‡·"},
"348":{nom:"Hongrie",capitale:"Budapest",pop:"9,7 M",superficie:"93 028 kmÂ²",continent:"Europe",drapeau:"ðŸ‡­ðŸ‡º"},
"352":{nom:"Islande",capitale:"Reykjavik",pop:"0,4 M",superficie:"103 000 kmÂ²",continent:"Europe",drapeau:"ðŸ‡®ðŸ‡¸"},
"356":{nom:"Inde",capitale:"New Delhi",pop:"1 407 M",superficie:"3 287 263 kmÂ²",continent:"Asie",drapeau:"ðŸ‡®ðŸ‡³"},
"360":{nom:"IndonÃ©sie",capitale:"Jakarta",pop:"275,5 M",superficie:"1 904 569 kmÂ²",continent:"Asie",drapeau:"ðŸ‡®ðŸ‡©"},
"364":{nom:"Iran",capitale:"TÃ©hÃ©ran",pop:"86,8 M",superficie:"1 648 195 kmÂ²",continent:"Asie",drapeau:"ðŸ‡®ðŸ‡·"},
"368":{nom:"Irak",capitale:"Bagdad",pop:"40,8 M",superficie:"438 317 kmÂ²",continent:"Asie",drapeau:"ðŸ‡®ðŸ‡¶"},
"372":{nom:"Irlande",capitale:"Dublin",pop:"5 M",superficie:"70 273 kmÂ²",continent:"Europe",drapeau:"ðŸ‡®ðŸ‡ª"},
"376":{nom:"IsraÃ«l",capitale:"JÃ©rusalem",pop:"9,2 M",superficie:"20 770 kmÂ²",continent:"Asie",drapeau:"ðŸ‡®ðŸ‡±"},
"380":{nom:"Italie",capitale:"Rome",pop:"59,6 M",superficie:"301 340 kmÂ²",continent:"Europe",drapeau:"ðŸ‡®ðŸ‡¹"},
"392":{nom:"Japon",capitale:"Tokyo",pop:"125,7 M",superficie:"377 975 kmÂ²",continent:"Asie",drapeau:"ðŸ‡¯ðŸ‡µ"},
"398":{nom:"Kazakhstan",capitale:"Astana",pop:"19,2 M",superficie:"2 724 900 kmÂ²",continent:"Asie",drapeau:"ðŸ‡°ðŸ‡¿"},
"410":{nom:"CorÃ©e du Sud",capitale:"SÃ©oul",pop:"51,7 M",superficie:"100 210 kmÂ²",continent:"Asie",drapeau:"ðŸ‡°ðŸ‡·"},
"428":{nom:"Lettonie",capitale:"Riga",pop:"1,9 M",superficie:"64 589 kmÂ²",continent:"Europe",drapeau:"ðŸ‡±ðŸ‡»"},
"440":{nom:"Lituanie",capitale:"Vilnius",pop:"2,8 M",superficie:"65 300 kmÂ²",continent:"Europe",drapeau:"ðŸ‡±ðŸ‡¹"},
"484":{nom:"Mexique",capitale:"Mexico City",pop:"130,3 M",superficie:"1 964 375 kmÂ²",continent:"AmÃ©rique du Nord",drapeau:"ðŸ‡²ðŸ‡½"},
"496":{nom:"Mongolie",capitale:"Oulan-Bator",pop:"3,3 M",superficie:"1 564 116 kmÂ²",continent:"Asie",drapeau:"ðŸ‡²ðŸ‡³"},
"504":{nom:"Maroc",capitale:"Rabat",pop:"37,5 M",superficie:"446 550 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡²ðŸ‡¦"},
"528":{nom:"Pays-Bas",capitale:"Amsterdam",pop:"17,6 M",superficie:"41 543 kmÂ²",continent:"Europe",drapeau:"ðŸ‡³ðŸ‡±"},
"554":{nom:"Nouvelle-ZÃ©lande",capitale:"Wellington",pop:"5,1 M",superficie:"268 021 kmÂ²",continent:"OcÃ©anie",drapeau:"ðŸ‡³ðŸ‡¿"},
"566":{nom:"NigÃ©ria",capitale:"Abuja",pop:"213,4 M",superficie:"923 768 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡³ðŸ‡¬"},
"578":{nom:"NorvÃ¨ge",capitale:"Oslo",pop:"5,4 M",superficie:"385 207 kmÂ²",continent:"Europe",drapeau:"ðŸ‡³ðŸ‡´"},
"586":{nom:"Pakistan",capitale:"Islamabad",pop:"220,9 M",superficie:"881 913 kmÂ²",continent:"Asie",drapeau:"ðŸ‡µðŸ‡°"},
"604":{nom:"PÃ©rou",capitale:"Lima",pop:"32,9 M",superficie:"1 285 216 kmÂ²",continent:"AmÃ©rique du Sud",drapeau:"ðŸ‡µðŸ‡ª"},
"608":{nom:"Philippines",capitale:"Manille",pop:"110,8 M",superficie:"300 000 kmÂ²",continent:"Asie",drapeau:"ðŸ‡µðŸ‡­"},
"616":{nom:"Pologne",capitale:"Varsovie",pop:"37,8 M",superficie:"312 685 kmÂ²",continent:"Europe",drapeau:"ðŸ‡µðŸ‡±"},
"620":{nom:"Portugal",capitale:"Lisbonne",pop:"10,3 M",superficie:"92 212 kmÂ²",continent:"Europe",drapeau:"ðŸ‡µðŸ‡¹"},
"642":{nom:"Roumanie",capitale:"Bucarest",pop:"19,2 M",superficie:"238 397 kmÂ²",continent:"Europe",drapeau:"ðŸ‡·ðŸ‡´"},
"643":{nom:"Russie",capitale:"Moscou",pop:"143,4 M",superficie:"17 098 242 kmÂ²",continent:"Europe / Asie",drapeau:"ðŸ‡·ðŸ‡º"},
"682":{nom:"Arabie Saoudite",capitale:"Riyad",pop:"35,3 M",superficie:"2 149 690 kmÂ²",continent:"Asie",drapeau:"ðŸ‡¸ðŸ‡¦"},
"688":{nom:"Serbie",capitale:"Belgrade",pop:"6,9 M",superficie:"77 474 kmÂ²",continent:"Europe",drapeau:"ðŸ‡·ðŸ‡¸"},
"703":{nom:"Slovaquie",capitale:"Bratislava",pop:"5,4 M",superficie:"49 035 kmÂ²",continent:"Europe",drapeau:"ðŸ‡¸ðŸ‡°"},
"705":{nom:"SlovÃ©nie",capitale:"Ljubljana",pop:"2,1 M",superficie:"20 273 kmÂ²",continent:"Europe",drapeau:"ðŸ‡¸ðŸ‡®"},
"710":{nom:"Afrique du Sud",capitale:"Pretoria",pop:"60 M",superficie:"1 219 090 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡¿ðŸ‡¦"},
"724":{nom:"Espagne",capitale:"Madrid",pop:"47,4 M",superficie:"505 990 kmÂ²",continent:"Europe",drapeau:"ðŸ‡ªðŸ‡¸"},
"752":{nom:"SuÃ¨de",capitale:"Stockholm",pop:"10,4 M",superficie:"450 295 kmÂ²",continent:"Europe",drapeau:"ðŸ‡¸ðŸ‡ª"},
"756":{nom:"Suisse",capitale:"Berne",pop:"8,7 M",superficie:"41 285 kmÂ²",continent:"Europe",drapeau:"ðŸ‡¨ðŸ‡­"},
"764":{nom:"ThaÃ¯lande",capitale:"Bangkok",pop:"71,6 M",superficie:"513 120 kmÂ²",continent:"Asie",drapeau:"ðŸ‡¹ðŸ‡­"},
"792":{nom:"Turquie",capitale:"Ankara",pop:"84,7 M",superficie:"783 356 kmÂ²",continent:"Asie / Europe",drapeau:"ðŸ‡¹ðŸ‡·"},
"804":{nom:"Ukraine",capitale:"Kyiv",pop:"41,4 M",superficie:"603 550 kmÂ²",continent:"Europe",drapeau:"ðŸ‡ºðŸ‡¦"},
"826":{nom:"Royaume-Uni",capitale:"Londres",pop:"67,1 M",superficie:"242 495 kmÂ²",continent:"Europe",drapeau:"ðŸ‡¬ðŸ‡§"},
"840":{nom:"Ã‰tats-Unis",capitale:"Washington D.C.",pop:"332,8 M",superficie:"9 833 517 kmÂ²",continent:"AmÃ©rique du Nord",drapeau:"ðŸ‡ºðŸ‡¸"},
"862":{nom:"Venezuela",capitale:"Caracas",pop:"28,7 M",superficie:"912 050 kmÂ²",continent:"AmÃ©rique du Sud",drapeau:"ðŸ‡»ðŸ‡ª"},
"704":{nom:"ViÃªt Nam",capitale:"HanoÃ¯",pop:"97,3 M",superficie:"331 212 kmÂ²",continent:"Asie",drapeau:"ðŸ‡»ðŸ‡³"},
"051":{nom:"ArmÃ©nie",capitale:"Erevan",pop:"3 M",superficie:"29 743 kmÂ²",continent:"Asie",drapeau:"ðŸ‡¦ðŸ‡²"},
"268":{nom:"GÃ©orgie",capitale:"Tbilissi",pop:"3,7 M",superficie:"69 700 kmÂ²",continent:"Asie",drapeau:"ðŸ‡¬ðŸ‡ª"},
"422":{nom:"Liban",capitale:"Beyrouth",pop:"6,8 M",superficie:"10 452 kmÂ²",continent:"Asie",drapeau:"ðŸ‡±ðŸ‡§"},
"760":{nom:"Syrie",capitale:"Damas",pop:"21,3 M",superficie:"185 180 kmÂ²",continent:"Asie",drapeau:"ðŸ‡¸ðŸ‡¾"},
"860":{nom:"OuzbÃ©kistan",capitale:"Tachkent",pop:"35,3 M",superficie:"448 978 kmÂ²",continent:"Asie",drapeau:"ðŸ‡ºðŸ‡¿"},
"231":{nom:"Ã‰thiopie",capitale:"Addis-Abeba",pop:"120 M",superficie:"1 104 300 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡ªðŸ‡¹"},
"894":{nom:"Zambie",capitale:"Lusaka",pop:"19,5 M",superficie:"752 618 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡¿ðŸ‡²"},
"516":{nom:"Namibie",capitale:"Windhoek",pop:"2,6 M",superficie:"824 292 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡³ðŸ‡¦"},
"324":{nom:"GuinÃ©e",capitale:"Conakry",pop:"13,5 M",superficie:"245 857 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡¬ðŸ‡³"},
"010":{nom:"Antarctique",capitale:"â€”",pop:"â€”",superficie:"14 000 000 kmÂ²",continent:"Antarctique",drapeau:"ðŸ§Š"},
"024":{nom:"Angola",capitale:"Luanda",pop:"34,5 M",superficie:"1 246 700 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡¦ðŸ‡´"},
"031":{nom:"AzerbaÃ¯djan",capitale:"Bakou",pop:"10,2 M",superficie:"86 600 kmÂ²",continent:"Asie",drapeau:"ðŸ‡¦ðŸ‡¿"},
"048":{nom:"BahreÃ¯n",capitale:"Manama",pop:"1,5 M",superficie:"778 kmÂ²",continent:"Asie",drapeau:"ðŸ‡§ðŸ‡­"},
"050":{nom:"Bangladesh",capitale:"Dacca",pop:"167 M",superficie:"147 570 kmÂ²",continent:"Asie",drapeau:"ðŸ‡§ðŸ‡©"},
"064":{nom:"Bhoutan",capitale:"Thimphou",pop:"0,7 M",superficie:"38 394 kmÂ²",continent:"Asie",drapeau:"ðŸ‡§ðŸ‡¹"},
"068":{nom:"Bolivie",capitale:"Sucre",pop:"12,1 M",superficie:"1 098 581 kmÂ²",continent:"AmÃ©rique du Sud",drapeau:"ðŸ‡§ðŸ‡´"},
"070":{nom:"Bosnie-HerzÃ©govine",capitale:"Sarajevo",pop:"3,3 M",superficie:"51 197 kmÂ²",continent:"Europe",drapeau:"ðŸ‡§ðŸ‡¦"},
"072":{nom:"Botswana",capitale:"Gaborone",pop:"2,6 M",superficie:"581 730 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡§ðŸ‡¼"},
"084":{nom:"Belize",capitale:"Belmopan",pop:"0,4 M",superficie:"22 966 kmÂ²",continent:"AmÃ©rique centrale",drapeau:"ðŸ‡§ðŸ‡¿"},
"090":{nom:"ÃŽles Salomon",capitale:"Honiara",pop:"0,7 M",superficie:"28 896 kmÂ²",continent:"OcÃ©anie",drapeau:"ðŸ‡¸ðŸ‡§"},
"096":{nom:"BrunÃ©i",capitale:"Bandar Seri Begawan",pop:"0,4 M",superficie:"5 765 kmÂ²",continent:"Asie",drapeau:"ðŸ‡§ðŸ‡³"},
"104":{nom:"Myanmar",capitale:"Naypyidaw",pop:"54,4 M",superficie:"676 578 kmÂ²",continent:"Asie",drapeau:"ðŸ‡²ðŸ‡²"},
"108":{nom:"Burundi",capitale:"Gitega",pop:"12,6 M",superficie:"27 834 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡§ðŸ‡®"},
"112":{nom:"BiÃ©lorussie",capitale:"Minsk",pop:"9,4 M",superficie:"207 600 kmÂ²",continent:"Europe",drapeau:"ðŸ‡§ðŸ‡¾"},
"116":{nom:"Cambodge",capitale:"Phnom Penh",pop:"16,7 M",superficie:"181 035 kmÂ²",continent:"Asie",drapeau:"ðŸ‡°ðŸ‡­"},
"120":{nom:"Cameroun",capitale:"YaoundÃ©",pop:"27,2 M",superficie:"475 442 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡¨ðŸ‡²"},
"132":{nom:"Cap-Vert",capitale:"Praia",pop:"0,6 M",superficie:"4 033 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡¨ðŸ‡»"},
"140":{nom:"RÃ©p. centrafricaine",capitale:"Bangui",pop:"5,0 M",superficie:"622 984 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡¨ðŸ‡«"},
"144":{nom:"Sri Lanka",capitale:"Sri Jayawardenepura Kotte",pop:"22 M",superficie:"65 610 kmÂ²",continent:"Asie",drapeau:"ðŸ‡±ðŸ‡°"},
"148":{nom:"Tchad",capitale:"N'Djamena",pop:"17,4 M",superficie:"1 284 000 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡¹ðŸ‡©"},
"158":{nom:"TaÃ¯wan",capitale:"Taipei",pop:"23,6 M",superficie:"35 980 kmÂ²",continent:"Asie",drapeau:"ðŸ‡¹ðŸ‡¼"},
"174":{nom:"Comores",capitale:"Moroni",pop:"0,9 M",superficie:"2 235 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡°ðŸ‡²"},
"178":{nom:"RÃ©publique du Congo",capitale:"Brazzaville",pop:"5,8 M",superficie:"342 000 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡¨ðŸ‡¬"},
"180":{nom:"RÃ©p. dÃ©m. du Congo",capitale:"Kinshasa",pop:"99,0 M",superficie:"2 344 858 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡¨ðŸ‡©"},
"188":{nom:"Costa Rica",capitale:"San JosÃ©",pop:"5,2 M",superficie:"51 100 kmÂ²",continent:"AmÃ©rique centrale",drapeau:"ðŸ‡¨ðŸ‡·"},
"192":{nom:"Cuba",capitale:"La Havane",pop:"11,3 M",superficie:"109 884 kmÂ²",continent:"AmÃ©rique",drapeau:"ðŸ‡¨ðŸ‡º"},
"196":{nom:"Chypre",capitale:"Nicosie",pop:"1,2 M",superficie:"9 251 kmÂ²",continent:"Europe",drapeau:"ðŸ‡¨ðŸ‡¾"},
"204":{nom:"BÃ©nin",capitale:"Porto-Novo",pop:"13,0 M",superficie:"112 622 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡§ðŸ‡¯"},
"214":{nom:"RÃ©p. dominicaine",capitale:"Saint-Domingue",pop:"11,1 M",superficie:"48 671 kmÂ²",continent:"AmÃ©rique",drapeau:"ðŸ‡©ðŸ‡´"},
"218":{nom:"Ã‰quateur",capitale:"Quito",pop:"18,0 M",superficie:"283 561 kmÂ²",continent:"AmÃ©rique du Sud",drapeau:"ðŸ‡ªðŸ‡¨"},
"222":{nom:"Salvador",capitale:"San Salvador",pop:"6,5 M",superficie:"21 041 kmÂ²",continent:"AmÃ©rique centrale",drapeau:"ðŸ‡¸ðŸ‡»"},
"232":{nom:"Ã‰rythrÃ©e",capitale:"Asmara",pop:"3,5 M",superficie:"117 600 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡ªðŸ‡·"},
"242":{nom:"Fidji",capitale:"Suva",pop:"0,9 M",superficie:"18 274 kmÂ²",continent:"OcÃ©anie",drapeau:"ðŸ‡«ðŸ‡¯"},
"262":{nom:"Djibouti",capitale:"Djibouti",pop:"1,0 M",superficie:"23 200 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡©ðŸ‡¯"},
"266":{nom:"Gabon",capitale:"Libreville",pop:"2,3 M",superficie:"267 668 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡¬ðŸ‡¦"},
"270":{nom:"Gambie",capitale:"Banjul",pop:"2,6 M",superficie:"11 295 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡¬ðŸ‡²"},
"275":{nom:"Palestine",capitale:"Ramallah",pop:"5,2 M",superficie:"6 020 kmÂ²",continent:"Asie",drapeau:"ðŸ‡µðŸ‡¸"},
"288":{nom:"Ghana",capitale:"Accra",pop:"32,8 M",superficie:"238 533 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡¬ðŸ‡­"},
"304":{nom:"Groenland",capitale:"Nuuk",pop:"0,06 M",superficie:"836 300 kmÂ²",continent:"AmÃ©rique du Nord",drapeau:"ðŸ‡¬ðŸ‡±"},
"320":{nom:"Guatemala",capitale:"Guatemala City",pop:"17,6 M",superficie:"108 889 kmÂ²",continent:"AmÃ©rique centrale",drapeau:"ðŸ‡¬ðŸ‡¹"},
"328":{nom:"Guyana",capitale:"Georgetown",pop:"0,8 M",superficie:"214 969 kmÂ²",continent:"AmÃ©rique du Sud",drapeau:"ðŸ‡¬ðŸ‡¾"},
"332":{nom:"HaÃ¯ti",capitale:"Port-au-Prince",pop:"11,4 M",superficie:"27 750 kmÂ²",continent:"AmÃ©rique",drapeau:"ðŸ‡­ðŸ‡¹"},
"340":{nom:"Honduras",capitale:"Tegucigalpa",pop:"10,3 M",superficie:"112 492 kmÂ²",continent:"AmÃ©rique centrale",drapeau:"ðŸ‡­ðŸ‡³"},
"384":{nom:"CÃ´te d'Ivoire",capitale:"Yamoussoukro",pop:"27,5 M",superficie:"322 463 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡¨ðŸ‡®"},
"388":{nom:"JamaÃ¯que",capitale:"Kingston",pop:"3 M",superficie:"10 990 kmÂ²",continent:"AmÃ©rique",drapeau:"ðŸ‡¯ðŸ‡²"},
"400":{nom:"Jordanie",capitale:"Amman",pop:"10,3 M",superficie:"89 342 kmÂ²",continent:"Asie",drapeau:"ðŸ‡¯ðŸ‡´"},
"404":{nom:"Kenya",capitale:"Nairobi",pop:"54,0 M",superficie:"580 367 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡°ðŸ‡ª"},
"408":{nom:"CorÃ©e du Nord",capitale:"Pyongyang",pop:"25,9 M",superficie:"120 538 kmÂ²",continent:"Asie",drapeau:"ðŸ‡°ðŸ‡µ"},
"414":{nom:"KoweÃ¯t",capitale:"KoweÃ¯t City",pop:"4,3 M",superficie:"17 818 kmÂ²",continent:"Asie",drapeau:"ðŸ‡°ðŸ‡¼"},
"417":{nom:"Kirghizstan",capitale:"Bichkek",pop:"6,7 M",superficie:"199 951 kmÂ²",continent:"Asie",drapeau:"ðŸ‡°ðŸ‡¬"},
"418":{nom:"Laos",capitale:"Vientiane",pop:"7,4 M",superficie:"236 800 kmÂ²",continent:"Asie",drapeau:"ðŸ‡±ðŸ‡¦"},
"426":{nom:"Lesotho",capitale:"Maseru",pop:"2,2 M",superficie:"30 355 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡±ðŸ‡¸"},
"430":{nom:"Liberia",capitale:"Monrovia",pop:"5,2 M",superficie:"111 369 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡±ðŸ‡·"},
"434":{nom:"Libye",capitale:"Tripoli",pop:"7,0 M",superficie:"1 759 540 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡±ðŸ‡¾"},
"442":{nom:"Luxembourg",capitale:"Luxembourg",pop:"0,7 M",superficie:"2 586 kmÂ²",continent:"Europe",drapeau:"ðŸ‡±ðŸ‡º"},
"450":{nom:"Madagascar",capitale:"Antananarivo",pop:"28,9 M",superficie:"587 041 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡²ðŸ‡¬"},
"454":{nom:"Malawi",capitale:"Lilongwe",pop:"20,2 M",superficie:"118 484 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡²ðŸ‡¼"},
"458":{nom:"Malaisie",capitale:"Kuala Lumpur",pop:"33,6 M",superficie:"329 847 kmÂ²",continent:"Asie",drapeau:"ðŸ‡²ðŸ‡¾"},
"466":{nom:"Mali",capitale:"Bamako",pop:"22,4 M",superficie:"1 240 192 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡²ðŸ‡±"},
"478":{nom:"Mauritanie",capitale:"Nouakchott",pop:"4,6 M",superficie:"1 030 700 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡²ðŸ‡·"},
"496":{nom:"Mongolie",capitale:"Oulan-Bator",pop:"3,3 M",superficie:"1 564 116 kmÂ²",continent:"Asie",drapeau:"ðŸ‡²ðŸ‡³"},
"498":{nom:"Moldavie",capitale:"ChiÈ™inÄƒu",pop:"2,6 M",superficie:"33 846 kmÂ²",continent:"Europe",drapeau:"ðŸ‡²ðŸ‡©"},
"508":{nom:"Mozambique",capitale:"Maputo",pop:"32,8 M",superficie:"801 590 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡²ðŸ‡¿"},
"512":{nom:"Oman",capitale:"Mascate",pop:"4,5 M",superficie:"309 500 kmÂ²",continent:"Asie",drapeau:"ðŸ‡´ðŸ‡²"},
"516":{nom:"Namibie",capitale:"Windhoek",pop:"2,6 M",superficie:"824 292 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡³ðŸ‡¦"},
"524":{nom:"NÃ©pal",capitale:"Katmandou",pop:"29,6 M",superficie:"147 181 kmÂ²",continent:"Asie",drapeau:"ðŸ‡³ðŸ‡µ"},
"540":{nom:"Nouvelle-CalÃ©donie",capitale:"NoumÃ©a",pop:"0,27 M",superficie:"18 575 kmÂ²",continent:"OcÃ©anie",drapeau:"ðŸ‡³ðŸ‡¨"},
"548":{nom:"Vanuatu",capitale:"Port-Vila",pop:"0,3 M",superficie:"12 189 kmÂ²",continent:"OcÃ©anie",drapeau:"ðŸ‡»ðŸ‡º"},
"558":{nom:"Nicaragua",capitale:"Managua",pop:"6,9 M",superficie:"130 373 kmÂ²",continent:"AmÃ©rique centrale",drapeau:"ðŸ‡³ðŸ‡®"},
"562":{nom:"Niger",capitale:"Niamey",pop:"25,1 M",superficie:"1 267 000 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡³ðŸ‡ª"},
"591":{nom:"Panama",capitale:"Panama City",pop:"4,4 M",superficie:"75 517 kmÂ²",continent:"AmÃ©rique centrale",drapeau:"ðŸ‡µðŸ‡¦"},
"598":{nom:"Papouasie-Nouvelle-GuinÃ©e",capitale:"Port Moresby",pop:"10,3 M",superficie:"462 840 kmÂ²",continent:"OcÃ©anie",drapeau:"ðŸ‡µðŸ‡¬"},
"600":{nom:"Paraguay",capitale:"AsunciÃ³n",pop:"7,4 M",superficie:"406 752 kmÂ²",continent:"AmÃ©rique du Sud",drapeau:"ðŸ‡µðŸ‡¾"},
"634":{nom:"Qatar",capitale:"Doha",pop:"2,9 M",superficie:"11 586 kmÂ²",continent:"Asie",drapeau:"ðŸ‡¶ðŸ‡¦"},
"646":{nom:"Rwanda",capitale:"Kigali",pop:"13,5 M",superficie:"26 338 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡·ðŸ‡¼"},
"686":{nom:"SÃ©nÃ©gal",capitale:"Dakar",pop:"17,2 M",superficie:"196 722 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡¸ðŸ‡³"},
"694":{nom:"Sierra Leone",capitale:"Freetown",pop:"8,2 M",superficie:"71 740 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡¸ðŸ‡±"},
"706":{nom:"Somalie",capitale:"Mogadiscio",pop:"17,1 M",superficie:"637 657 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡¸ðŸ‡´"},
"716":{nom:"Zimbabwe",capitale:"Harare",pop:"15,0 M",superficie:"390 757 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡¿ðŸ‡¼"},
"728":{nom:"Soudan du Sud",capitale:"Djouba",pop:"10,9 M",superficie:"619 745 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡¸ðŸ‡¸"},
"729":{nom:"Soudan",capitale:"Khartoum",pop:"45,7 M",superficie:"1 861 484 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡¸ðŸ‡©"},
"732":{nom:"Sahara occidental",capitale:"LaÃ¢youne",pop:"0,6 M",superficie:"266 000 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡ªðŸ‡­"},
"740":{nom:"Suriname",capitale:"Paramaribo",pop:"0,6 M",superficie:"163 820 kmÂ²",continent:"AmÃ©rique du Sud",drapeau:"ðŸ‡¸ðŸ‡·"},
"762":{nom:"Tadjikistan",capitale:"DouchanbÃ©",pop:"9,9 M",superficie:"143 100 kmÂ²",continent:"Asie",drapeau:"ðŸ‡¹ðŸ‡¯"},
"768":{nom:"Togo",capitale:"LomÃ©",pop:"8,5 M",superficie:"56 785 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡¹ðŸ‡¬"},
"780":{nom:"TrinitÃ©-et-Tobago",capitale:"Port of Spain",pop:"1,4 M",superficie:"5 128 kmÂ²",continent:"AmÃ©rique",drapeau:"ðŸ‡¹ðŸ‡¹"},
"784":{nom:"Ã‰mirats arabes unis",capitale:"Abou Dabi",pop:"9,9 M",superficie:"83 600 kmÂ²",continent:"Asie",drapeau:"ðŸ‡¦ðŸ‡ª"},
"795":{nom:"TurkmÃ©nistan",capitale:"Achgabat",pop:"6,1 M",superficie:"488 100 kmÂ²",continent:"Asie",drapeau:"ðŸ‡¹ðŸ‡²"},
"800":{nom:"Ouganda",capitale:"Kampala",pop:"47,1 M",superficie:"241 038 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡ºðŸ‡¬"},
"807":{nom:"MacÃ©doine du Nord",capitale:"Skopje",pop:"2,1 M",superficie:"25 713 kmÂ²",continent:"Europe",drapeau:"ðŸ‡²ðŸ‡°"},
"834":{nom:"Tanzanie",capitale:"Dodoma",pop:"63,3 M",superficie:"945 087 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡¹ðŸ‡¿"},
"854":{nom:"Burkina Faso",capitale:"Ouagadougou",pop:"22,1 M",superficie:"274 200 kmÂ²",continent:"Afrique",drapeau:"ðŸ‡§ðŸ‡«"},
"858":{nom:"Uruguay",capitale:"Montevideo",pop:"3,5 M",superficie:"176 215 kmÂ²",continent:"AmÃ©rique du Sud",drapeau:"ðŸ‡ºðŸ‡¾"},
"882":{nom:"Samoa",capitale:"Apia",pop:"0,2 M",superficie:"2 831 kmÂ²",continent:"OcÃ©anie",drapeau:"ðŸ‡¼ðŸ‡¸"},
"887":{nom:"YÃ©men",capitale:"Sanaa",pop:"33,7 M",superficie:"527 968 kmÂ²",continent:"Asie",drapeau:"ðŸ‡¾ðŸ‡ª"},
};

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LITERARY FORMS â€” with city & continuity data
   Each event can have:
     countryId: ISO 3166-1 numeric (string)
     title, detail: text
     city: { lat, lon, nom_actuel,
             noms: [{ nom, local?, debut, fin }] }
       â†’ noms is an array of period-specific names, resolved by event year.
         debut/fin are years (use -9999/9999 for open bounds).
         If noms is absent, nom_actuel is used.
     inheritsFrom: ["entityId"] â€” cultural continuity (per-form)
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

/* City name resolver */
function resolveCityName(city, year) {
  if (city.noms) {
    const match = city.noms.find(n => year >= n.debut && year < n.fin);
    if (match) return { nom: match.nom, local: match.local || null };
  }
  return { nom: city.nom_actuel || "?", local: null };
}

const LITERARY_FORMS = {

  ecritures: {
    label: "Ã‰critures",
    desc: "PremiÃ¨res attestations des grands systÃ¨mes d'Ã©criture : du cunÃ©iforme sumÃ©rien (c. 3300 av. J.-C.) aux alphabets crÃ©Ã©s au XIXeâ€“XXe siÃ¨cles. Dates approximatives selon l'Ã©tat des fouilles et des dÃ©chiffrements.",
    timeline: [
      { year: -3400, events: [
        { countryId:"364", title:"Ã‰criture proto-Ã©lamite â€” Suse",
          detail:"Plus anciens signes d'Ã©criture attestÃ©s (c. 3400â€“3300 av. J.-C.). Pictogrammes liÃ©s Ã  la comptabilitÃ©. Non dÃ©chiffrÃ©e. PrÃ©cÃ¨de de quelques dÃ©cennies le cunÃ©iforme sumÃ©rien.",
          city:{ lat:32.19, lon:48.25, nom_actuel:"Shush (Suse)",
            noms:[{nom:"Suse",local:"ð’€­ð’‹¢ð’Šº",debut:-9999,fin:9999}] }},
        { countryId:"368", title:"CunÃ©iforme proto-sumÃ©rien â€” Uruk",
          detail:"Tablettes d'Uruk : premiers pictogrammes sumÃ©riens (c. 3300 av. J.-C.), bientÃ´t phonÃ©tisÃ©s en syllabes. AncÃªtre de tous les systÃ¨mes cunÃ©iformes. Invention liÃ©e Ã  la comptabilitÃ© des surplus agricoles.",
          city:{ lat:31.32, lon:45.62, nom_actuel:"Warka",
            noms:[{nom:"Uruk",local:"ð’€•ð’†³",debut:-9999,fin:300}] }}
      ]},
      { year: -3200, events: [
        { countryId:"818", title:"HiÃ©roglyphes Ã©gyptiens â€” Abydos",
          detail:"PremiÃ¨res inscriptions hiÃ©roglyphiques (tombe U-j, Abydos, c. 3200 av. J.-C.). SystÃ¨me Ã  la fois logographique et consonantique. Restera en usage jusqu'Ã  394 apr. J.-C., puis sera dÃ©chiffrÃ© par Champollion en 1822.",
          city:{ lat:26.18, lon:31.92, nom_actuel:"Abydos",
            noms:[{nom:"Abdju / Abydos",local:"ð“‡‹ð“ƒ€ð“†“ð“…±",debut:-9999,fin:9999}] }}
      ]},
      { year: -2600, events: [
        { countryId:"586", title:"Ã‰criture de l'Indus â€” Mohenjo-daro",
          detail:"~400 signes attestÃ©s sur sceaux et tablettes (c. 2600â€“1900 av. J.-C.). Non dÃ©chiffrÃ©e. DisparaÃ®t avec le dÃ©clin de la civilisation harappÃ©enne vers 1900 av. J.-C. L'une des grandes Ã©nigmes de la palÃ©ographie.",
          city:{ lat:27.33, lon:68.14, nom_actuel:"Mohenjo-daro",
            noms:[{nom:"Mohenjo-daro",local:"Ù…ÙˆØ¦Ù† Ø¬Ùˆ Ø¯Ú™Ùˆ",debut:-9999,fin:9999}] }}
      ]},
      { year: -1800, events: [
        { countryId:"818", title:"Ã‰criture protosinaÃ¯tique â€” SinaÃ¯ / Levant",
          detail:"Premier alphabet consonantique (abjad) : ~30 signes dÃ©rivÃ©s de hiÃ©roglyphes Ã©gyptiens. C. 1800 av. J.-C. Mines de Serabit el-Khadim (SinaÃ¯, territoire Ã©gyptien). AncÃªtre de tous les alphabets phÃ©niciens, sÃ©mitiques, grecs et latins. RÃ©volution : une Ã©criture apprenante Ã  30 signes contre 700 pour les hiÃ©roglyphes.",
          city:{ lat:29.00, lon:33.50, nom_actuel:"Serabit el-Khadim (SinaÃ¯)",
            noms:[{nom:"Serabit el-Khadim",debut:-9999,fin:9999}] }}
      ]},
      { year: -1600, events: [
        { countryId:"156", title:"Ã‰criture oraculaire sur os (jiÇŽgÇ”wÃ©n) â€” Anyang",
          detail:"Premiers caractÃ¨res chinois attestÃ©s (~1600â€“1046 av. J.-C., Shang). Logogrammes gravÃ©s sur os et Ã©cailles de tortue pour les oracles. AncÃªtre direct de l'Ã©criture chinoise moderne.",
          city:{ lat:36.13, lon:114.33, nom_actuel:"Anyang",
            noms:[{nom:"Yin / Anyang",local:"æ®·",debut:-9999,fin:1600},{nom:"Anyang",local:"å®‰é˜³",debut:1600,fin:9999}] }}
      ]},
      { year: -1500, events: [
        { countryId:"300", title:"LinÃ©aire B â€” MycÃ¨nes / Cnossos",
          detail:"Syllabaire notÃ© sur tablettes d'argile. DÃ©chiffrÃ© en 1952 par Michael Ventris. Note le grec mycÃ©nien (indo-europÃ©en). Disparu c. 1200 av. J.-C. lors de l'effondrement de l'Ã‚ge du Bronze.",
          city:{ lat:37.73, lon:22.76, nom_actuel:"MycÃ¨nes",
            noms:[{nom:"Myká¸—nai",local:"ÎœÏ…Îºá¿†Î½Î±Î¹",debut:-9999,fin:9999}] }}
      ]},
      { year: -1400, events: [
        { countryId:"760", title:"Alphabet ougaritique â€” Ougarit",
          detail:"Alphabet cunÃ©iforme de 30 signes (c. 1400â€“1185 av. J.-C.). Ougarit (cÃ´te syrienne). DisparaÃ®t avec la destruction de la ville par les Peuples de la Mer. Textes religieux fondamentaux pour la comprÃ©hension du sÃ©mitique.",
          city:{ lat:35.60, lon:35.78, nom_actuel:"Ras Shamra",
            noms:[{nom:"Ougarit",local:"ð’Œ‘ð’‚µð’Š‘ð’Œ…",debut:-9999,fin:-1185}] }}
      ]},
      { year: -1050, events: [
        { countryId:"422", title:"Alphabet phÃ©nicien â€” Byblos / Tyr",
          detail:"22 consonnes. L'alphabet phÃ©nicien se rÃ©pand dans tout le bassin mÃ©diterranÃ©en grÃ¢ce au commerce maritime. AncÃªtre direct des alphabets hÃ©breu, aramÃ©en, arabe, grec et latin.",
          city:{ lat:34.12, lon:35.65, nom_actuel:"Jbeil (Byblos)",
            noms:[{nom:"Byblos / Gubla",local:"ð¤‚ð¤ð¤‹",debut:-9999,fin:9999}] }}
      ]},
      { year: -800, events: [
        { countryId:"300", title:"Alphabet grec archaÃ¯que â€” GrÃ¨ce",
          detail:"Adaptation du phÃ©nicien avec ajout de voyelles : premiÃ¨re Ã©criture Ã  noter voyelles ET consonnes. RÃ©volution qui rend la lecture accessible. AncÃªtre du latin (via l'Ã©trusque), du cyrillique et de l'armÃ©nien.",
          city:{ lat:37.97, lon:23.73, nom_actuel:"AthÃ¨nes",
            noms:[{nom:"AthÃ¨nes",local:"á¼ˆÎ¸á¿†Î½Î±Î¹",debut:-9999,fin:9999}] }}
      ]},
      { year: -600, events: [
        { countryId:"380", title:"Alphabet latin â€” Rome",
          detail:"DÃ©rivÃ© du grec via l'alphabet Ã©trusque. C. 600 av. J.-C. Deviendra l'alphabet le plus rÃ©pandu au monde. UtilisÃ© aujourd'hui par ~70 % de la population mondiale.",
          city:{ lat:41.90, lon:12.50, nom_actuel:"Rome",
            noms:[{nom:"Roma",local:"ROMA",debut:-9999,fin:9999}] }},
        { countryId:"356", title:"Brahmi â€” Inde",
          detail:"C. 500â€“300 av. J.-C. Abugida (syllabaire Ã  voyelles inhÃ©rentes). AncÃªtre de la quasi-totalitÃ© des Ã©critures d'Asie du Sud et du Sud-Est : devanagari, bengali, khmÃ¨re, thaÃ¯, tibÃ©tain, birmaneâ€¦",
          city:{ lat:25.32, lon:82.97, nom_actuel:"Varanasi",
            noms:[{nom:"VÄrÄá¹‡asÄ« / KÄÅ›Ä«",local:"à¤µà¤¾à¤°à¤¾à¤£à¤¸à¥€",debut:-9999,fin:9999}] }}
      ]},
      { year: -250, events: [
        { countryId:"818", title:"Ã‰criture mÃ©roÃ¯tique â€” Royaume de MÃ©roÃ©",
          detail:"Alphabet de 23 signes dÃ©rivÃ© des hiÃ©roglyphes. Royaume de MÃ©roÃ© (Soudan actuel). En usage c. 300 av. J.-C.â€“400 apr. J.-C. Partiellement dÃ©chiffrÃ©e : sons connus, sens souvent obscur.",
          city:{ lat:16.94, lon:33.74, nom_actuel:"MÃ©roÃ© (Soudan)",
            noms:[{nom:"MÃ©roÃ©",local:"ð“¤ð“‡‹ð“ƒ€ð“‡‹ð“‡‹ð“¯ð“…±",debut:-9999,fin:400}] }}
      ]},
      { year: 100, events: [
        { countryId:"578", title:"Runes germaniques (Futhark ancien) â€” Scandinavie",
          detail:"24 signes. Scandinavie et Europe du Nord (c. 150â€“700 apr. J.-C.). DÃ©rivÃ© probable du latin ou de l'alphabet des Alpes orientales. Usages rituels, commÃ©moratifs, Ã©pigraphiques. Usage rÃ©gional Ã©tendu, sans localisation ponctuelle." }
      ]},
      { year: 400, events: [
        { countryId:"051", title:"Alphabet armÃ©nien â€” Machtots",
          detail:"CrÃ©Ã© c. 405 apr. J.-C. par Mesrop Machtots sur instruction du roi Vramshapuh. 38 lettres. DÃ¨s l'origine, liÃ© Ã  la traduction de la Bible. Langue et Ã©criture encore utilisÃ©es sans discontinuitÃ©.",
          city:{ lat:40.18, lon:44.51, nom_actuel:"Erevan",
            noms:[{nom:"VaÅ‚arÅ¡apat",local:"ÕŽÕ¡Õ²Õ¡Ö€Õ·Õ¡ÕºÕ¡Õ¿",debut:-9999,fin:1900},{nom:"Erevan",local:"ÔµÖ€Ö‡Õ¡Õ¶",debut:1900,fin:9999}] }},
        { countryId:"268", title:"Alphabet gÃ©orgien (asomtavruli)",
          detail:"C. 430 apr. J.-C. (premiÃ¨re attestation). Tradition attribue la crÃ©ation Ã  Mesrop Machtots ou au roi Pharnavaz. LiÃ© dÃ¨s l'origine Ã  la traduction des Ã‰vangiles. Unique au monde.",
          city:{ lat:41.69, lon:44.83, nom_actuel:"Tbilissi",
            noms:[{nom:"Mtskheta",local:"áƒ›áƒªáƒ®áƒ”áƒ—áƒ",debut:-9999,fin:500},{nom:"Tbilissi",local:"áƒ—áƒ‘áƒ˜áƒšáƒ˜áƒ¡áƒ˜",debut:500,fin:9999}] }}
      ]},
      { year: 430, events: [
        { countryId:"231", title:"Ã‰criture Ã©thiopienne â€” Ge'ez (Fidel)",
          detail:"DÃ©rivÃ©e du sudarabique sabÃ©en. Abugida de 231 syllabes (7 formes par consonne selon la voyelle). Encore utilisÃ©e pour l'amharique (langue officielle d'Ã‰thiopie), le tigrigna et le guÃ¨ze liturgique.",
          city:{ lat:14.33, lon:38.93, nom_actuel:"Aksoum",
            noms:[{nom:"Aksoum / Axoum",local:"áŠ áŠ­áˆ±áˆ",debut:-9999,fin:9999}] }}
      ]},
      { year: 600, events: [
        { countryId:"682", title:"Ã‰criture arabe â€” Arabie / Levant",
          detail:"DÃ©rivÃ©e du nabatÃ©en (aramÃ©en). 28 lettres consonantiques, sens droit â†’ gauche. C. 600 apr. J.-C. LiÃ©e Ã  la rÃ©vÃ©lation coranique. DeuxiÃ¨me systÃ¨me d'Ã©criture par nombre de locuteurs. RÃ©pandue de l'Espagne Ã  l'IndonÃ©sie.",
          city:{ lat:21.42, lon:39.82, nom_actuel:"La Mecque",
            noms:[{nom:"Makka al-Mukarrama",local:"Ù…ÙƒØ© Ø§Ù„Ù…ÙƒØ±Ù…Ø©",debut:-9999,fin:9999}] }}
      ]},
      { year: 650, events: [
        { countryId:"156", title:"Ã‰criture tibÃ©taine (Ucen) â€” Tibet",
          detail:"CrÃ©Ã©e sous le roi Songtsen Gampo pour noter le tibÃ©tain. DÃ©rivÃ©e du gupta (Inde). LiÃ©e Ã  la traduction du canon bouddhiste tibÃ©tain â€” l'une des plus grandes entreprises de traduction de l'histoire.",
          city:{ lat:29.65, lon:91.12, nom_actuel:"Lhassa",
            noms:[{nom:"Rasa / Lhassa",local:"à½£à¾·à¼‹à½¦à¼",debut:-9999,fin:9999}] }}
      ]},
      { year: 700, events: [
        { countryId:"392", title:"Man'yÅgana â†’ Kana â€” Japon",
          detail:"Le man'yÅgana (VIIe s.) note le japonais phonÃ©tiquement avec des sinogrammes. Le hiragana et le katakana (syllabaires de 46 signes chacun) en sont dÃ©rivÃ©s au IXe s. SystÃ¨me toujours en usage combinÃ© aux kanji.",
          city:{ lat:34.69, lon:135.50, nom_actuel:"Nara",
            noms:[{nom:"HeijÅ-kyÅ / Nara",local:"å¹³åŸŽäº¬",debut:710,fin:784},{nom:"Nara",local:"å¥ˆè‰¯",debut:784,fin:9999}] }}
      ]},
      { year: 863, events: [
        { countryId:"100", title:"Alphabet cyrillique â€” Cyrille et MÃ©thode",
          detail:"CrÃ©Ã© par les frÃ¨res thessaloniciens Cyrille et MÃ©thode (~863) pour noter le vieux slave liturgique. DÃ©rivÃ© du grec oncial. RÃ©pandu dans le monde orthodoxe slave. UtilisÃ© aujourd'hui par ~250 M de personnes.",
          city:{ lat:41.99, lon:21.43, nom_actuel:"MacÃ©doine du Nord (Ohrid)",
            noms:[{nom:"Ohrid",local:"ÐžÑ…Ñ€Ð¸Ð´",debut:-9999,fin:9999}] }}
      ]},
      { year: 1000, events: [
        { countryId:"484", title:"Ã‰criture maya â€” MÃ©soamÃ©rique (apogÃ©e classique)",
          detail:"Logosyllabique : ~800 glyphes. Premiers signes c. IIIe s. av. J.-C. DÃ©chiffrement progressif depuis les annÃ©es 1950â€“1980 (Knorozov, Houston, Stuart). Milieu du Xe s. : apogÃ©e des inscriptions classiques.",
          city:{ lat:17.25, lon:-89.62, nom_actuel:"Caracol / ChichÃ©n ItzÃ¡",
            noms:[{nom:"ChichÃ©n ItzÃ¡",local:"ChichÃ©n ItzÃ¡",debut:-9999,fin:9999}] }}
      ]},
      { year: 1443, events: [
        { countryId:"410", title:"Hangul â€” roi Sejong le Grand",
          detail:"CrÃ©Ã© en 1443, promulguÃ© en 1446 (Hunmin Jeongeum). Alphabet phonÃ©tico-syllabique de 24 lettres. L'un des rares systÃ¨mes d'Ã©criture dont la date et l'auteur sont connus avec certitude. Taux d'alphabÃ©tisation de la CorÃ©e : 99 %.",
          city:{ lat:37.58, lon:126.98, nom_actuel:"SÃ©oul",
            noms:[{nom:"Hanyang",local:"æ¼¢é™½",debut:-9999,fin:1910},{nom:"SÃ©oul",local:"ì„œìš¸",debut:1910,fin:9999}] }}
      ]},
      { year: 1821, events: [
        { countryId:"840", title:"Syllabaire cherokee â€” SÃ©quoyah",
          detail:"InventÃ© par SÃ©quoyah (George Guess), locuteur cherokee non alphabÃ©tisÃ©. 85 syllabes. Adoption quasi totale de la nation cherokee en moins de 5 ans. Exemple unique d'invention d'Ã©criture par un locuteur en dehors de toute tradition alphabÃ¨te.",
          city:{ lat:35.46, lon:-84.57, nom_actuel:"Territoire cherokee (Tennessee/GÃ©orgie)",
            noms:[{nom:"Territoire cherokee",debut:-9999,fin:9999}] }}
      ]},
      { year: 1949, events: [
        { countryId:"324", title:"Alphabet N'Ko â€” Solomana Kante",
          detail:"CrÃ©Ã© en 1949 par Solomana Kante (GuinÃ©e). Alphabet de droite Ã  gauche pour les langues mandÃ© (bambara, dioula, malinkÃ©). UtilisÃ© en alphabÃ©tisation, presse, Ã©dition religieuse. Reconnaissance internationale croissante.",
          city:{ lat:10.05, lon:-9.70, nom_actuel:"Kankan (GuinÃ©e)",
            noms:[{nom:"Kankan",debut:-9999,fin:9999}] }}
      ]}
    ]
  },

  versLibre: {
    label: "Vers libre",
    desc: "Triple histoire du vers libre : pseudotraductions romantiques (masque de l'Ã©tranger pour passer des formes nouvelles en contrebande), vers libre littÃ©raire mondial (Whitman, MaÃ¯akovski, modernismes brÃ©silien et chinois, Beat), et vers libre en traduction savante ou littÃ©raire (hexamÃ¨tre grec, parallÃ©lismes bibliques, Ã©popÃ©es extra-europÃ©ennes). Les trois fils se nouent en 1886.",
    timeline: [
      { year: 1827, events: [
        { countryId:"250", title:"La Guzla â€” Prosper MÃ©rimÃ©e (pseudotraduction)",
          detail:"PoÃ¨mes illyriens fictifs prÃ©sentÃ©s comme traduits de la Dalmatie. MÃ©rimÃ©e invente un style 'barbare', sans rime ni mÃ¨tre rÃ©gulier, impossible Ã  publier sous signature franÃ§aise directe. Mystifie Goethe et Pouchkine. Selon Christine Lombez, la pseudotraduction est le vecteur clandestin d'introduction de formes prosodiques nouvelles : la tolÃ©rance du lectorat est plus grande pour une dÃ©viance attribuÃ©e Ã  l'Ã©tranger.",
          city:{ lat:48.86, lon:2.35, nom_actuel:"Paris" }}
      ]},
      { year: 1831, events: [
        { countryId:"250", title:"Nerval : pseudotraductions de l'allemand",
          detail:"GÃ©rard de Nerval publie dans Le Mercure de France des poÃ¨mes attribuÃ©s Ã  Jean-Paul Richter et Ã  BÃ¼rger, dont aucun original allemand n'a jamais Ã©tÃ© retrouvÃ©. L'un d'eux, d'abord en prose, sera rÃ©appropriÃ© en vers dans les Odelettes. La frontiÃ¨re entre vraie et fausse traduction rÃ©vÃ¨le l'espace d'expÃ©rimentation que la pseudotraduction ouvre au poÃ¨te.",
          city:{ lat:48.86, lon:2.35, nom_actuel:"Paris" }}
      ]},
      { year: 1856, events: [
        { countryId:"840", title:"Leaves of Grass â€” Walt Whitman",
          detail:"Fondation du vers libre moderne anglophone. Long verset blanc influencÃ© par la Bible hÃ©braÃ¯que (parallÃ©lismes), Carlyle et les Ã©popÃ©es homÃ©riques. Whitman s'adresse directement au lecteur dans un 'je' dÃ©mesurÃ© et dÃ©mocratique. IgnorÃ© Ã  sa sortie, il sera redÃ©couvert en Europe avant de conquÃ©rir l'AmÃ©rique.",
          city:{ lat:40.71, lon:-73.99, nom_actuel:"New York",
            noms:[{nom:"New York",debut:-9999,fin:9999}] }}
      ]},
      { year: 1866, events: [
        { countryId:"250", title:"Iliade / OdyssÃ©e â€” Leconte de Lisle (traduction)",
          detail:"Prose poÃ©tique rythmÃ©e et archaÃ¯sante refusant l'alexandrin. Premier grand refus du mÃ¨tre classique franÃ§ais pour rendre HomÃ¨re. Pose la question centrale de la traductologie poÃ©tique franÃ§aise : comment rendre l'hexamÃ¨tre dactylique dans une langue syllabique sans le trahir ?",
          city:{ lat:48.86, lon:2.35, nom_actuel:"Paris" }}
      ]},
      { year: 1886, events: [
        { countryId:"250", title:"Brins d'herbes â€” Laforgue traduit Whitman (La Vogue)",
          detail:"Jules Laforgue publie ses traductions de Leaves of Grass dans La Vogue en juin 1886. La semaine suivante paraissent ses premiers vers libres personnels dans la mÃªme revue. MÃªme numÃ©ro : les Illuminations de Rimbaud. Gustave Kahn, MorÃ©as et Laforgue publient simultanÃ©ment des vers libres. Moment fondateur : la traduction comme catalyseur du vers libre franÃ§ais (Lombez, Romantisme, 2008).",
          city:{ lat:48.86, lon:2.35, nom_actuel:"Paris" }},
        { countryId:"056", title:"Ã‰mile Verhaeren â€” Les Soirs / Les DÃ©bÃ¢cles",
          detail:"Le grand poÃ¨te belge s'empare du vers libre symboliste avec une puissance rythmique exceptionnelle. Les Soirs (1887), Les DÃ©bÃ¢cles, Les Flambeaux noirs. Verhaeren est le premier poÃ¨te francophone Ã  faire du vers libre une forme majeure et non expÃ©rimentale â€” influence dÃ©cisive sur Stefan Zweig, Romain Rolland, et les poÃ¨tes expressionnistes.",
          city:{ lat:50.85, lon:4.35, nom_actuel:"Bruxelles" }}
      ]},
      { year: 1907, events: [
        { countryId:"250", title:"PremiÃ¨re traduction franÃ§aise de Gilgamesh â€” Ã‰douard Dhorme",
          detail:"Vers libre savant nÃ© de la contrainte philologique : les parallÃ©lismes de la poÃ©sie akkadienne sont intraduisibles en mÃ¨tre classique. Disposition en courts segments mimant la structure originale. Le savant invente un vers libre fonctionnel avant que le terme soit pleinement lÃ©gitimÃ©.",
          city:{ lat:48.86, lon:2.35, nom_actuel:"Paris" }}
      ]},
      { year: 1912, events: [
        { countryId:"826", title:"Imagisme â€” Ezra Pound, H.D., Amy Lowell",
          detail:"Pound fonde l'Imagisme Ã  Londres avec Hilda Doolittle (H.D.) et Richard Aldington. RÃ¨gles : image directe, Ã©conomie de mot, libertÃ© rythmique. Pound lie explicitement le vers libre anglophone Ã  la traduction de la poÃ©sie chinoise (Cathay, 1915) et japonaise. L'Imagisme irrigue tout le vers libre anglophone du XXe siÃ¨cle.",
          city:{ lat:51.51, lon:-0.13, nom_actuel:"Londres",
            noms:[{nom:"Londres",debut:-9999,fin:9999}] }},
        { countryId:"643", title:"MaÃ¯akovski â€” La FlÃ»te des vertÃ¨bres / premiers poÃ¨mes",
          detail:"Vladimir MaÃ¯akovski invente le vers-escalier (Ð»ÐµÑÐµÐ½ÐºÐ°), disposition typographique oÃ¹ chaque marche correspond Ã  une unitÃ© rythmique accentuelle. Rupture radicale avec la mÃ©trique syllabo-tonique russe. Vers libre au service d'une voix urbaine, futuriste, rÃ©volutionnaire. Influence dÃ©cisive sur Ai Qing et toute la poÃ©sie du monde soviÃ©tique et post-colonial.",
          city:{ lat:55.75, lon:37.62, nom_actuel:"Moscou" }}
      ]},
      { year: 1922, events: [
        { countryId:"826", title:"The Waste Land â€” T. S. Eliot",
          detail:"SynthÃ¨se du vers libre moderniste anglophone. Eliot mÃªle citations (Dante, Shakespeare, la Bible bouddhiste), langues (anglais, allemand, franÃ§ais, sanskrit) et registres dans une composition polyphonique. ProfondÃ©ment influencÃ© par Laforgue et le symbolisme franÃ§ais. Prix Nobel 1948.",
          city:{ lat:51.51, lon:-0.13, nom_actuel:"Londres",
            noms:[{nom:"Londres",debut:-9999,fin:9999}] }},
        { countryId:"076", title:"Semaine d'Art Moderne â€” SÃ£o Paulo",
          detail:"Fondation du modernisme brÃ©silien. MÃ¡rio de Andrade : PaulicÃ©ia Desvairada (vers libre urbain, polyphonique). Oswald de Andrade : vers court, syncopÃ©, 'cannibale'. Manuel Bandeira : vers libre mÃ©lancolique. Rupture radicale avec le Parnasse portugais.",
          city:{ lat:-23.55, lon:-46.63, nom_actuel:"SÃ£o Paulo" }},
        { countryId:"156", title:"Bing Xin (å†°å¿ƒ) â€” Ã‰toiles et Printemps",
          detail:"Bing Xin (Xie Wanying) publie ses premiers recueils de vers libres, inspirÃ©s de Tagore et Whitman lus en traduction anglaise. Courts poÃ¨mes fragmentÃ©s, prose lyrique d'une douceur nouvelle. PremiÃ¨re grande poÃ©tesse chinoise moderne ; son Å“uvre influencera directement Ai Qing.",
          city:{ lat:39.91, lon:116.39, nom_actuel:"PÃ©kin" }}
      ]},
      { year: 1930, events: [
        { countryId:"643", title:"MaÃ¯akovski â€” Ã€ pleine voix (Ã€ pleine gorge)",
          detail:"Dernier grand poÃ¨me. MaÃ¯akovski y rÃ©sume son programme poÃ©tique : le vers-escalier comme oralisation visible du discours, la rime comme percussion et non ornementation. Il se suicide en avril 1930. Ses poÃ¨mes seront traduits en vers libres dans des dizaines de langues, propageant le modÃ¨le du vers rythmique accentuel non mÃ©trique.",
          city:{ lat:55.75, lon:37.62, nom_actuel:"Moscou" }}
      ]},
      { year: 1933, events: [
        { countryId:"156", title:"La RiviÃ¨re de Dayan â€” Ai Qing (è‰¾é’)",
          detail:"Ai Qing (Jiang Zhenghan) Ã©crit son long poÃ¨me La RiviÃ¨re de Dayan (å¤§å °æ²³, 1933) en prison. Vers libre Ã©pique et engagÃ©, influencÃ© Ã  la fois par Whitman et par le vers-escalier de MaÃ¯akovski. Deviendra la figure centrale de la poÃ©sie chinoise du XXe siÃ¨cle.",
          city:{ lat:30.26, lon:120.21, nom_actuel:"Hangzhou" }}
      ]},
      { year: 1939, events: [
        { countryId:"604", title:"Poemas humanos â€” CÃ©sar Vallejo",
          detail:"Ã‰crits Ã  Paris, publiÃ©s posthumÃ©ment. Vers libre espagnol d'une Ã©trangetÃ© syntaxique radicale : Vallejo brise la grammaire pour exprimer la douleur collective. Influence dÃ©cisive sur toute la poÃ©sie hispanoamÃ©ricaine du XXe siÃ¨cle.",
          city:{ lat:48.86, lon:2.35, nom_actuel:"Paris" }}
      ]},
      { year: 1947, events: [
        { countryId:"474", title:"Cahier d'un retour au pays natal â€” AimÃ© CÃ©saire",
          detail:"Long verset surrÃ©aliste et africain. CÃ©saire forge un vers libre qui dÃ©vore toutes les langues pour restituer la violence coloniale et l'Ã©lan de la nÃ©gritude. PubliÃ© d'abord en 1939 dans VolontÃ©s, l'Ã©dition dÃ©finitive avec prÃ©face de Breton paraÃ®t en 1947.",
          city:{ lat:14.62, lon:-61.02, nom_actuel:"Fort-de-France" }}
      ]},
      { year: 1955, events: [
        { countryId:"250", title:"OdyssÃ©e â€” Philippe Jaccottet (traduction)",
          detail:"Vers libres de longueur variable (souvent 14 pieds). Choix dÃ©libÃ©rÃ© de ne pas imposer l'alexandrin Ã  HomÃ¨re. Club franÃ§ais du livre. Moment fondateur pour la traduction littÃ©raire en vers libres en franÃ§ais : Jaccottet thÃ©orise la nÃ©cessitÃ© de laisser la syntaxe grecque respirer dans la langue d'arrivÃ©e.",
          city:{ lat:48.86, lon:2.35, nom_actuel:"Paris" }},
        { countryId:"840", title:"Howl â€” Allen Ginsberg",
          detail:"Long verset whitmanien scandÃ© lors d'une lecture Ã  San Francisco (Gallery Six, oct. 1955). Ginsberg renoue avec le catalogue, l'anaphore, le souffle Ã©pique de Whitman. ProcÃ¨s pour obscÃ©nitÃ©. Acte fondateur de la Beat Generation et du vers libre comme voix de la contre-culture.",
          city:{ lat:37.77, lon:-122.42, nom_actuel:"San Francisco" }}
      ]},
      { year: 1962, events: [
        { countryId:"250", title:"Shakespeare â€” Yves Bonnefoy (traduction)",
          detail:"Hamlet (1962), Jules CÃ©sar, Le Roi Lear, Macbeth. Vers libres refusant de mimer le pentamÃ¨tre iambique par l'alexandrin. Bonnefoy thÃ©orise la traduction comme geste d'Ã©criture Ã  part entiÃ¨re dans L'acte et le lieu de la poÃ©sie : le traducteur est auteur.",
          city:{ lat:48.86, lon:2.35, nom_actuel:"Paris" }}
      ]},
      { year: 1970, events: [
        { countryId:"250", title:"Les cinq rouleaux â€” Henri Meschonnic (traduction)",
          detail:"Bible en vers libres rythmÃ©s selon l'oralitÃ© hÃ©braÃ¯que, sans ponctuation, en lignes de longueur variable calquÃ©es sur les accents du texte massorÃ©tique. Meschonnic thÃ©orisera ce geste dans Pour la poÃ©tique II (1973) : le rythme n'est pas mÃ©trique mais organisation du discours.",
          city:{ lat:48.86, lon:2.35, nom_actuel:"Paris" }}
      ]},
      { year: 1930, events: [
        { countryId:"076", title:"Libertinagem â€” Manuel Bandeira",
          detail:"Le recueil emblÃ©matique du vers libre brÃ©silien, publiÃ© en 1930. Bandeira, surnommÃ© 'SÃ£o JoÃ£o Batista du modernisme brÃ©silien', y perfectionne un vers libre intime, ironique, populaire â€” ni acadÃ©mique ni futuriste. PoÃ¨mes comme 'Vou-me embora pra PasÃ¡rgada' ou 'O Ãšltimo Poema' montrent la maÃ®trise d'un vers libre qui n'imite plus, mais invente.",
          city:{ lat:-22.91, lon:-43.17, nom_actuel:"Rio de Janeiro" }}
      ]},
      { year: 2009, events: [
        { countryId:"250", title:"Iliade â€” Jean-Louis BackÃ¨s (traduction)",
          detail:"Gallimard. Vers libres au service d'une syntaxe homÃ©rique respectÃ©e. Rejets et enjambements fonctionnels : la coupure de ligne isole des mots-clÃ©s, crÃ©e des suspensions. BackÃ¨s a thÃ©orisÃ© dans l'Histoire des traductions en langue franÃ§aise (Verdier, XIXe s.) le rÃ´le de la traduction comme vecteur d'introduction du vers libre en France.",
          city:{ lat:48.86, lon:2.35, nom_actuel:"Paris" }}
      ]},
      { year: 2017, events: [
        { countryId:"250", title:"MÃ©tamorphoses â€” Marie Cosnay (traduction)",
          detail:"Ã‰ditions de l'Ogre. 10 ans de travail. 12 000 vers d'Ovide en vers libres d'une Ã©trangetÃ© assumÃ©e. DÃ©crochages de registre, syntaxe proche du latin, mots d'Ovide parfois conservÃ©s. Prix Nelly-Sachs 2018. Le vers libre comme outil de restitution de la voix orale et plurielle d'Ovide.",
          city:{ lat:48.86, lon:2.35, nom_actuel:"Paris" }}
      ]}
    ]
  },

  haiku: {
    label: "HaÃ¯ku",
    desc: "PoÃ¨me bref issu du hokku d'ouverture du renga. NÃ© au Japon au XVIIe siÃ¨cle, codifiÃ© par BashÅ, rÃ©formÃ© par Shiki (qui en forge le nom), le haÃ¯ku circule dans le monde entier au XXe siÃ¨cle. Le dÃ©bat entre forme fixe (5-7-5) et vers libre traverse son histoire.",
    timeline: [
      { year: 1672, events: [
        { countryId:"392", title:"Kai ÅŒi â€” Matsuo BashÅ",
          detail:"BashÅ (1644â€“1694) publie son premier recueil. Il Ã©lÃ¨ve le hokku (strophe d'ouverture du renga) au rang de poÃ¨me autonome et le dote d'une profondeur philosophique et zen. Son Ã©cole, le style ShÅfÅ«, fixe les principes du genre : kigo (mot de saison), kireji (coupe), yugen, sabi.",
          city:{ lat:35.00, lon:135.77, nom_actuel:"Kyoto",
            noms:[{nom:"Kyoto",local:"äº¬éƒ½",debut:-9999,fin:9999}] }}
      ]},
      { year: 1689, events: [
        { countryId:"392", title:"Oku no hosomichi â€” Matsuo BashÅ",
          detail:"Chef-d'Å“uvre du haibun (prose et haÃ¯ku entrelacÃ©s). Le vieux bassin aux grenouilles (furuike ya, 1686) est le haÃ¯ku le plus commentÃ© de l'histoire. BashÅ transforme le voyage en mÃ©ditation sur l'impermanence.",
          city:{ lat:35.69, lon:139.69, nom_actuel:"Tokyo",
            noms:[{nom:"Edo",local:"æ±Ÿæˆ¸",debut:-9999,fin:1868},{nom:"Tokyo",local:"æ±äº¬",debut:1868,fin:9999}] }}
      ]},
      { year: 1750, events: [
        { countryId:"392", title:"Yosa Buson â€” haÃ¯ku pictural",
          detail:"Buson (1716â€“1783), peintre et poÃ¨te, renouvelle le genre aprÃ¨s BashÅ par une plasticitÃ© visuelle raffinÃ©e et une sensibilitÃ© aux couleurs et aux textures. Son haÃ¯ku est moins zen que celui de BashÅ, plus sensoriel et littÃ©raire.",
          city:{ lat:34.69, lon:135.50, nom_actuel:"Osaka" }}
      ]},
      { year: 1810, events: [
        { countryId:"392", title:"Kobayashi Issa â€” haÃ¯ku de la compassion",
          detail:"Issa (1763â€“1827) compose des haÃ¯kus empreints d'une tendresse douloureuse pour les Ãªtres faibles (insectes, enfants, grenouilles). Autobiographie poÃ©tique : Oraga haru (Ma Primavera, 1819). Style populaire, humour et tristesse mÃªlÃ©s. Plus de 20 000 haÃ¯kus composÃ©s.",
          city:{ lat:36.69, lon:138.18, nom_actuel:"Shinano (Nagano)",
            noms:[{nom:"Kashiwabara",local:"æŸåŽŸ",debut:-9999,fin:9999}] }}
      ]},
      { year: 1897, events: [
        { countryId:"392", title:"Masaoka Shiki â€” rÃ©forme et revue Hototogisu",
          detail:"Shiki (1867â€“1902) forge le terme 'haÃ¯ku' (vs hokku) et fonde la revue Hototogisu. Il prÃ´ne le shasei (croquis sur le vif) contre l'imitation de BashÅ. Il rÃ©habilite Buson. Sa rÃ©forme engendre deux courants contradictoires : la fidÃ©litÃ© au 5-7-5 et au kigo (Kyoshi), ou la libertÃ© formelle radicale (HekigotÅ).",
          city:{ lat:35.69, lon:139.69, nom_actuel:"Tokyo" }}
      ]},
      { year: 1910, events: [
        { countryId:"392", title:"Kawahigashi HekigotÅ â€” haÃ¯ku en vers libre",
          detail:"HekigotÅ (1873â€“1937), disciple de Shiki, pousse la rÃ©forme jusqu'Ã  l'abandon du 5-7-5 (jiyuritsu haiku) et du kigo. HaÃ¯ku sans centre, sans saison, parfois long. Radicalisation moderniste : le haÃ¯ku rejoint les avant-gardes. DÃ©bat fondateur qui traverse tout le XXe siÃ¨cle.",
          city:{ lat:35.69, lon:139.69, nom_actuel:"Tokyo" }},
        { countryId:"392", title:"Taneda SantÅka â€” haÃ¯ku errant",
          detail:"SantÅka (1882â€“1940), moine mendiant, buveur et marcheur. HaÃ¯ku en vers libre, sans kigo, dictÃ©s par l'errance et le zen. Ã‰conomie extrÃªme, ligne unique souvent. PoÃ©sie du dÃ©pouillement : 'simplement en marchant / je marche'. RedÃ©couvert dans les annÃ©es 1970 comme voix majeure.",
          city:{ lat:33.65, lon:130.70, nom_actuel:"Matsuyama / chemin de pÃ¨lerinage" }}
      ]},
      { year: 1905, events: [
        { countryId:"250", title:"Paul-Louis Couchoud â€” premiers haÃ¯kus en franÃ§ais",
          detail:"Couchoud publie Au fil de l'eau (1905), premier recueil de haÃ¯kus en franÃ§ais, puis Sages et poÃ¨tes d'Asie (1916). Il introduit la forme en Europe et pose le problÃ¨me de la syllabe franÃ§aise vs japonaise. Les symbolistes franÃ§ais s'en emparent.",
          city:{ lat:48.86, lon:2.35, nom_actuel:"Paris" }}
      ]},
      { year: 1913, events: [
        { countryId:"840", title:"Ezra Pound â€” haÃ¯ku imagiste",
          detail:"'In a Station of the Metro' (Poetry, 1913) : 'The apparition of these faces in the crowd / Petals on a wet, black bough.' Pound dÃ©crit explicitement ce poÃ¨me comme un haÃ¯ku en anglais â€” image directe, aucune explication. L'Imagisme codifie l'influence du haÃ¯ku sur le vers libre anglophone.",
          city:{ lat:51.51, lon:-0.13, nom_actuel:"Londres",
            noms:[{nom:"Londres",debut:-9999,fin:9999}] }}
      ]},
      { year: 1919, events: [
        { countryId:"484", title:"JosÃ© Juan Tablada â€” haÃ¯ku hispanique",
          detail:"Tablada publie Un dÃ­a (1919) au Mexique, premier recueil de haÃ¯kus en espagnol. Il introduit la forme en AmÃ©rique latine avec un naturalisme luxuriant. Influence sur LÃ³pez Velarde, Paz et tout le haÃ¯ku hispanique.",
          city:{ lat:19.43, lon:-99.13, nom_actuel:"Mexico" }}
      ]},
      { year: 1955, events: [
        { countryId:"840", title:"Jack Kerouac â€” haÃ¯ku Beat",
          detail:"Kerouac compose des haÃ¯kus amÃ©ricains tout au long des annÃ©es 1950 (publiÃ©s posthumÃ©ment dans Book of Haikus, 2003). Il intÃ¨gre zen bouddhiste, jazz et spontanÃ©itÃ© beatnik dans la forme. 'Haiku = not 17 syllables but 3 short lines'. Allen Ginsberg pratique Ã©galement la forme.",
          city:{ lat:37.77, lon:-122.42, nom_actuel:"San Francisco" }}
      ]},
      { year: 1968, events: [
        { countryId:"840", title:"Haiku Society of America â€” diffusion mondiale",
          detail:"FondÃ©e en 1968. Publie Frogpond. Le haÃ¯ku anglophone se stabilise et rayonne dans le monde entier. DÃ©bat permanent : compter les syllabes (anglaises vs japonaises) ? garder le kigo ? La Haiku International Association (1989, Tokyo) tente de coordonner les pratiques mondiales.",
          city:{ lat:40.71, lon:-73.99, nom_actuel:"New York" }}
      ]},
      { year: 2000, events: [
        { countryId:"250", title:"HaÃ¯ku francophone contemporain",
          detail:"La revue HaÃ¯ku (France, fondÃ©e 2003), Ploc! La lettre du haÃ¯ku. PoÃ¨tes : Jean Antonini, Dominique Chipot, Gilles Fabre. Question centrale : quel Ã©quivalent au 5-7-5 en franÃ§ais, oÃ¹ la syllabe est diffÃ©rente ? Le haÃ¯ku francophone cherche ses propres kigo culturels (chÃ¢taignes, Toussaint, TGVâ€¦).",
          city:{ lat:48.86, lon:2.35, nom_actuel:"Paris" }}
      ]}
    ]
  },

  romanPolicier: {
    label: "Roman policier",
    desc: "RÃ©cit centrÃ© sur l'Ã©lucidation d'un crime, nÃ© aux Ã‰tats-Unis au milieu du XIXe siÃ¨cle.",
    timeline: [
      { year: 1841, events: [
        { countryId:"840", title:"Double assassinat dans la rue Morgue â€” E. A. Poe",
          detail:"PremiÃ¨re nouvelle policiÃ¨re. Poe invente le dÃ©tective raisonneur Auguste Dupin.",
          city:{ lat:39.9526, lon:-75.1652, nom_actuel:"Philadelphia",
            noms:[{nom:"Philadelphie",debut:-9999,fin:9999}] }}
      ]},
      { year: 1866, events: [
        { countryId:"250", title:"L'Affaire Lerouge â€” Ã‰mile Gaboriau",
          detail:"Premier roman policier franÃ§ais. Gaboriau crÃ©e Monsieur Lecoq.",
          city:{ lat:48.8566, lon:2.3522, nom_actuel:"Paris" }}
      ]},
      { year: 1887, events: [
        { countryId:"826", title:"A Study in Scarlet â€” Arthur Conan Doyle",
          detail:"PremiÃ¨re apparition de Sherlock Holmes et du Dr Watson.",
          city:{ lat:51.5074, lon:-0.1278, nom_actuel:"London",
            noms:[{nom:"Londres",debut:-9999,fin:9999}] }}
      ]},
      { year: 1920, events: [
        { countryId:"826", title:"La MystÃ©rieuse Affaire de Styles â€” Agatha Christie",
          detail:"Premier roman d'Hercule Poirot. Christie deviendra la reine du whodunit.",
          city:{ lat:51.5074, lon:-0.1278, nom_actuel:"London",
            noms:[{nom:"Londres",debut:-9999,fin:9999}] }}
      ]},
      { year: 1929, events: [
        { countryId:"056", title:"Pietr-le-Letton â€” Georges Simenon",
          detail:"Premier roman du commissaire Maigret. Simenon ancre le polar dans le quotidien.",
          city:{ lat:48.8566, lon:2.3522, nom_actuel:"Paris" }}
      ]},
      { year: 1939, events: [
        { countryId:"840", title:"The Big Sleep â€” Raymond Chandler",
          detail:"Chef-d'Å“uvre du roman noir hard-boiled. Philip Marlowe face Ã  la corruption de L.A.",
          city:{ lat:34.0522, lon:-118.2437, nom_actuel:"Los Angeles" }}
      ]},
      { year: 1965, events: [
        { countryId:"752", title:"Roseanna â€” SjÃ¶wall & WahlÃ¶Ã¶",
          detail:"Premier volume de Martin Beck. Acte fondateur du polar scandinave.",
          city:{ lat:59.3293, lon:18.0686, nom_actuel:"Stockholm" }}
      ]}
    ]
  },

  dialoguePhilo: {
    label: "Dialogue philosophique",
    desc: "Forme littÃ©raire mettant en scÃ¨ne un Ã©change argumentÃ© entre interlocuteurs. NÃ©e en Inde et en GrÃ¨ce antiques, elle circule Ã  travers les traditions bouddhique, islamique et europÃ©enne.",
    timeline: [
      { year: -500, events: [
        { countryId:"356", title:"Suttas du Canon pÄli â€” Entretiens du Bouddha",
          detail:"Les suttas mettent en scÃ¨ne SiddhÄrtha Gautama dialoguant avec disciples, brahmanes et rois. Transmis oralement, ils seront fixÃ©s par Ã©crit au Ier s. av. J.-C. au Sri Lanka.",
          city:{ lat:25.60, lon:85.13, nom_actuel:"Patna",
            noms:[{nom:"RÄjagá¹›ha",local:"à¤°à¤¾à¤œà¤—à¥ƒà¤¹",debut:-9999,fin:-400},{nom:"PÄá¹­aliputra",local:"à¤ªà¤¾à¤Ÿà¤²à¤¿à¤ªà¥à¤¤à¥à¤°",debut:-400,fin:600},{nom:"Patna",debut:600,fin:9999}] }},
        { countryId:"300", title:"Premiers dialogues socratiques â€” Platon",
          detail:"Platon compose les premiers dialogues mettant en scÃ¨ne Socrate : Apologie, Ion, Hippias mineur. Naissance du genre en GrÃ¨ce.",
          city:{ lat:37.9838, lon:23.7275, nom_actuel:"Athens",
            noms:[{nom:"AthÃ¨nes",local:"á¼ˆÎ¸á¿†Î½Î±Î¹",debut:-9999,fin:9999}] }}
      ]},
      { year: -380, events: [
        { countryId:"300", title:"La RÃ©publique, Le Banquet â€” Platon",
          detail:"Grands dialogues de la maturitÃ©. Platon porte le genre Ã  son apogÃ©e littÃ©raire et philosophique.",
          city:{ lat:37.9838, lon:23.7275, nom_actuel:"Athens",
            noms:[{nom:"AthÃ¨nes",local:"á¼ˆÎ¸á¿†Î½Î±Î¹",debut:-9999,fin:9999}] }}
      ]},
      { year: -300, events: [
        { countryId:"156", title:"Mencius (Mengzi) â€” Entretiens",
          detail:"Mengzi dialogue avec princes et lettrÃ©s pour dÃ©fendre la bontÃ© innÃ©e de la nature humaine. Texte fondateur du confucianisme.",
          city:{ lat:35.57, lon:116.98, nom_actuel:"Zoucheng",
            noms:[{nom:"ZÅu",local:"é„’",debut:-9999,fin:9999}] }}
      ]},
      { year: -150, events: [
        { countryId:"586", title:"MilindapaÃ±ha â€” Questions du roi Milinda",
          detail:"Dialogue entre le roi indo-grec MÃ©nandre et le moine NÄgasena. Rencontre entre pensÃ©e bouddhique et dialectique grecque.",
          city:{ lat:34.01, lon:71.58, nom_actuel:"Peshawar",
            noms:[{nom:"SÄgala / GandhÄra",local:"à¤—à¤¨à¥à¤§à¤¾à¤°",debut:-9999,fin:9999}] }}
      ]},
      { year: -45, events: [
        { countryId:"380", title:"Tusculanes, De natura deorum â€” CicÃ©ron",
          detail:"CicÃ©ron adapte le dialogue philosophique grec au latin. Il en fait un vÃ©hicule de la pensÃ©e romaine.",
          city:{ lat:41.9028, lon:12.4964, nom_actuel:"Rome",
            noms:[{nom:"Roma",local:"Roma",debut:-9999,fin:9999}] }}
      ]},
      { year: 165, events: [
        { countryId:"792", title:"Dialogues des morts, IcaromÃ©nippe â€” Lucien de Samosate",
          detail:"Lucien dÃ©tourne le dialogue philosophique en satire. Influence considÃ©rable sur Ã‰rasme et Voltaire.",
          city:{ lat:37.08, lon:38.29, nom_actuel:"ÅžanlÄ±urfa",
            noms:[{nom:"Samosate",local:"Î£Î±Î¼ÏŒÏƒÎ±Ï„Î±",debut:-9999,fin:9999}] }}
      ]},
      { year: 400, events: [
        { countryId:"012", title:"Soliloques, De Magistro â€” Augustin d'Hippone",
          detail:"Augustin christianise le dialogue philosophique. Le De Magistro met en scÃ¨ne un Ã©change avec son fils AdÃ©odat.",
          city:{ lat:36.89, lon:7.75, nom_actuel:"Annaba",
            noms:[{nom:"Hippone",local:"Hippo Regius",debut:-9999,fin:700},{nom:"BÃ´ne",debut:700,fin:1962},{nom:"Annaba",debut:1962,fin:9999}] }}
      ]},
      { year: 750, events: [
        { countryId:"392", title:"Dialogues du Chan / Zen â€” kÅan et mondÅ",
          detail:"Les maÃ®tres Chan en Chine puis Zen au Japon dÃ©veloppent le mondÅ (questions-rÃ©ponses) et le kÅan, formes radicalement dialogiques.",
          city:{ lat:35.0116, lon:135.7681, nom_actuel:"Kyoto",
            noms:[{nom:"Heian-kyÅ",local:"å¹³å®‰äº¬",debut:794,fin:1868},{nom:"Kyoto",local:"äº¬éƒ½",debut:1868,fin:9999},{nom:"â€”",debut:-9999,fin:794}] }}
      ]},
      { year: 1000, events: [
        { countryId:"368", title:"Al-ImtÄÊ¿ wa-l-muÊ¾Änasa â€” AbÅ« á¸¤ayyÄn al-Tawá¸¥Ä«dÄ«",
          detail:"37 nuits de conversation entre al-Tawá¸¥Ä«dÄ« et le vizir Ibn SaÊ¿dÄn. Chef-d'Å“uvre de l'adab dialogique arabe.",
          city:{ lat:33.3152, lon:44.3661, nom_actuel:"Baghdad",
            noms:[{nom:"Bagdad",local:"Ø¨ØºØ¯Ø§Ø¯",debut:-9999,fin:9999}] }}
      ]},
      { year: 1528, events: [
        { countryId:"380", title:"Le Livre du Courtisan â€” Baldassare Castiglione",
          detail:"Dialogue de cour Ã  Urbino. Castiglione ressuscite le modÃ¨le cicÃ©ronien dans la Renaissance italienne.",
          city:{ lat:43.73, lon:12.64, nom_actuel:"Urbino" }}
      ]},
      { year: 1713, events: [
        { countryId:"826", title:"Three Dialogues â€” George Berkeley",
          detail:"Berkeley met en scÃ¨ne Hylas et Philonous pour dÃ©fendre l'immatÃ©rialisme. Le dialogue devient instrument de la philosophie empiriste.",
          city:{ lat:51.5074, lon:-0.1278, nom_actuel:"London",
            noms:[{nom:"Londres",debut:-9999,fin:9999}] }}
      ]},
      { year: 1769, events: [
        { countryId:"250", title:"Le Neveu de Rameau â€” Denis Diderot",
          detail:"Dialogue satirique entre 'Moi' et 'Lui'. Diderot pousse la forme vers la dialectique sociale. PubliÃ© posthumÃ©ment.",
          city:{ lat:48.8566, lon:2.3522, nom_actuel:"Paris" }}
      ]},
      { year: 1923, events: [
        { countryId:"250", title:"L'Ã‚me et la Danse, Eupalinos â€” Paul ValÃ©ry",
          detail:"ValÃ©ry rÃ©invente le dialogue platonicien en y mÃªlant poÃ©tique et architecture. Derniers grands dialogues littÃ©raires franÃ§ais.",
          city:{ lat:48.8566, lon:2.3522, nom_actuel:"Paris" }}
      ]}
    ]
  }
};

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   HISTORICAL ERAS â€” structure for future historical borders
   For now, modern borders are used. This structure allows
   plugging in historical GeoJSON and entity renaming.
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const HISTORICAL_ERAS = [
  { start:-4000, end:-500,  label:"Haute AntiquitÃ©",
    notes:"MÃ©sopotamie, Ã‰gypte ancienne, civilisation de l'Indus",
    entities:{
      /* Future: map modern countryIds to historical entity names */
      /* "818": { nom:"Ã‰gypte ancienne", type:"kingdom" }, */
      /* "368": { nom:"MÃ©sopotamie", type:"region" }, */
    }},
  { start:-500, end:476,   label:"AntiquitÃ© classique",
    entities:{
      /* "300": { nom:"GrÃ¨ce antique / Empire romain d'Orient" }, */
      /* "380": { nom:"RÃ©publique / Empire romain" }, */
    }},
  { start:476,  end:1000,  label:"Haut Moyen Ã‚ge",  entities:{}},
  { start:1000, end:1500,  label:"Moyen Ã‚ge tardif", entities:{}},
  { start:1500, end:1789,  label:"Ã‰poque moderne",   entities:{}},
  { start:1789, end:1914,  label:"XIXe siÃ¨cle",      entities:{}},
  { start:1914, end:1945,  label:"Guerres mondiales", entities:{}},
  { start:1945, end:2030,  label:"Ã‰poque contemporaine", entities:{}},
];

/* Helper: get era for a given year */
function getEra(year) {
  return HISTORICAL_ERAS.find(e => year >= e.start && year < e.end) || HISTORICAL_ERAS[HISTORICAL_ERAS.length-1];
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PROJECTION CONFIG
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const PROJ_CONFIG = {
  naturalEarth1: {
    label:"Natural Earth",
    desc:"Projection Natural Earth â€” Ã©quilibre entre forme et surface.",
    make(w,h,pad){ return d3.geoNaturalEarth1().fitExtent([[pad,pad],[w-pad,h-pad]], {type:"Sphere"}); }
  },
  equirectangular: {
    label:"Ã‰quirectangulaire",
    desc:"Projection Ã©quirectangulaire â€” latitude/longitude en coordonnÃ©es directes.",
    make(w,h,pad){ return d3.geoEquirectangular().fitExtent([[pad,pad],[w-pad,h-pad]], {type:"Sphere"}); }
  },
  orthographic: {
    label:"Orthographique",
    desc:"Vue depuis l'espace. Faites glisser pour pivoter le globe.",
    make(w,h,pad){ return d3.geoOrthographic().clipAngle(90).rotate([-10,-25]).fitExtent([[pad,pad],[w-pad,h-pad]], {type:"Sphere"}); }
  },
  azimuthalEqualArea: {
    label:"Polaire",
    desc:"Projection azimutale centrÃ©e sur le PÃ´le Nord.",
    make(w,h,pad){ return d3.geoAzimuthalEqualArea().rotate([0,-90]).clipAngle(150).fitExtent([[pad,pad],[w-pad,h-pad]], {type:"Sphere"}); }
  }
};

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   GLOBAL STATE
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let COUNTRIES = [];
let currentProj = "naturalEarth1";
let currentForm = "ecritures";
let currentDateIdx = 0;
let highlightedMap = {};   /* countryId â†’ [events] */
let cityList = [];          /* flat list of cities to render */
let mainProj = null;        /* current d3 projection (main map) */
let mainPath = null;        /* current d3 path generator */
let mainZoom = null;        /* d3.zoom instance */
let currentTransform = d3.zoomIdentity;

const GRAT = d3.geoGraticule();
const MW = 960, MH = 520, MPAD = 28;
const GW = 360, GH = 190, GPAD = 10;

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   UTILS
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function cid(d) { return String(d.id).padStart(3,"0"); }
function getPays(d) { const r=String(d.id), p=r.padStart(3,"0"); return PAYS[r]||PAYS[p]||null; }
function getForm() { return LITERARY_FORMS[currentForm]; }

/* Compute highlighted countries + cities (cumulative up to dateIdx) */
function computeHighlighted() {
  const form = getForm(), maxYear = form.timeline[currentDateIdx].year;
  const map = {}; const cities = [];
  for (const entry of form.timeline) {
    if (entry.year > maxYear) break;
    for (const evt of entry.events) {
      const id = evt.countryId;
      if (!map[id]) map[id] = [];
      const evtFull = { ...evt, year: entry.year };
      map[id].push(evtFull);
      if (evt.city) {
        const cn = resolveCityName(evt.city, entry.year);
        cities.push({ ...evt.city, _resolvedNom: cn.nom, _resolvedLocal: cn.local, countryId: id, year: entry.year, title: evt.title, detail: evt.detail });
      }
    }
  }
  /* Cultural continuity: if event declares inheritsFrom, copy events */
  /* (structure ready â€” no demo data yet, but the mechanism works) */
  for (const [id, evts] of Object.entries(map)) {
    for (const evt of evts) {
      if (evt.inheritsFrom) {
        for (const srcId of evt.inheritsFrom) {
          if (map[srcId]) {
            if (!map[id]._inherited) map[id]._inherited = [];
            map[id]._inherited.push(...map[srcId].map(e => ({...e, _inheritedFrom: srcId})));
          }
        }
      }
    }
  }
  highlightedMap = map;
  cityList = cities;
}

function isHighlighted(d) { return !!highlightedMap[cid(d)]; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   AUTO-ZOOM: fit view to CURRENT DATE's countries + cities
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function computeAutoBounds() {
  const form = getForm();
  const entry = form.timeline[currentDateIdx];
  if (!entry) return null;
  /* Collect countryIds for current date's events */
  const currentIds = new Set();
  for (const evt of entry.events) {
    if (evt.countryId) currentIds.add(evt.countryId);
  }
  if (currentIds.size === 0) return null;
  const features = COUNTRIES.filter(d => currentIds.has(cid(d)));
  if (features.length === 0) return null;
  return { type:"FeatureCollection", features };
}

function autoZoom(svg, proj, path, animate) {
  const fc = computeAutoBounds();
  if (!fc || !mainZoom) return;
  /* compute pixel bounds of highlighted features */
  const bounds = path.bounds(fc);
  const dx = bounds[1][0] - bounds[0][0];
  const dy = bounds[1][1] - bounds[0][1];
  const cx = (bounds[0][0] + bounds[1][0]) / 2;
  const cy = (bounds[0][1] + bounds[1][1]) / 2;
  const pad = 60;
  const scale = Math.min(MW / (dx + pad*2), MH / (dy + pad*2), 8);
  const clampedScale = Math.max(1, Math.min(scale, 8));
  const tx = MW/2 - cx * clampedScale;
  const ty = MH/2 - cy * clampedScale;
  const t = d3.zoomIdentity.translate(tx, ty).scale(clampedScale);
  if (animate) {
    svg.transition().duration(700).call(mainZoom.transform, t);
  } else {
    svg.call(mainZoom.transform, t);
  }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BUILD MAP (main or gallery)
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function buildMap(svgEl, projName, w, h, pad, interactive) {
  const svg = d3.select(svgEl);
  const proj = PROJ_CONFIG[projName].make(w, h, pad);
  const path = d3.geoPath().projection(proj);
  svg.selectAll("*").remove();

  /* container group for zoom transforms */
  const g = svg.append("g").attr("class","map-g");

  g.append("path").datum({type:"Sphere"}).attr("class","sphere-fill").attr("d", path);
  g.append("path").datum(GRAT()).attr("class","graticule").attr("d", path);

  const cp = g.selectAll(".country").data(COUNTRIES).join("path")
    .attr("d", path)
    .attr("class", d => "country" + (interactive && isHighlighted(d) ? " lit-active" : ""));

  if (interactive) {
    cp.on("mousemove", (evt, d) => showTip(evt, d, "country"))
      .on("mouseleave", hideTip);
  }

  g.append("path").datum({type:"Sphere"}).attr("class","sphere-border").attr("d", path);

  /* CITIES â€” only on interactive (main) map */
  if (interactive && cityList.length > 0) {
    const cityG = g.append("g").attr("class","cities-layer");
    const merged = mergeCities(cityList);
    for (const c of merged) {
      const pt = proj([c.lon, c.lat]);
      if (!pt || isNaN(pt[0])) continue;
      const cg = cityG.append("g").attr("class","city-group");
      cg.append("circle")
        .attr("class","city-dot")
        .attr("cx", pt[0]).attr("cy", pt[1])
        .attr("r", 4)
        .attr("data-lon", c.lon).attr("data-lat", c.lat)
        .on("mouseenter", function(evt) {
          const k = (currentTransform && currentTransform.k) ? currentTransform.k : 1;
          d3.select(this).transition().duration(120).attr("r", 6/k);
          showCityTip(evt, c);
        })
        .on("mousemove", function(evt) { showCityTip(evt, c); })
        .on("mouseleave", function() {
          const k = (currentTransform && currentTransform.k) ? currentTransform.k : 1;
          d3.select(this).transition().duration(200).attr("r", 4/k);
          hideTip();
        });
      cg.append("text")
        .attr("class","city-label")
        .attr("x", pt[0]).attr("y", pt[1] + 8)
        .text(c._resolvedNom + (c._resolvedLocal ? " ("+c._resolvedLocal+")" : ""));
    }
  }

  /* Zoom setup for main map */
  if (interactive) {
    mainProj = proj; mainPath = path;
    if (projName === "orthographic") {
      /* orthographic: no zoom/pan, only globe drag */
      mainZoom = null;
      document.getElementById("zoom-controls").style.display = "none";
    } else {
      mainZoom = d3.zoom()
        .scaleExtent([1, 12])
        .on("zoom", (evt) => {
          currentTransform = evt.transform;
          g.attr("transform", evt.transform);
          const k = evt.transform.k;
          g.selectAll(".city-dot").attr("r", 4/k);
          g.selectAll(".city-label").style("font-size", (9/k)+"px");
          g.selectAll(".country").style("stroke-width", (0.4/k)+"px");
          g.selectAll(".country.lit-active").style("stroke-width", (0.6/k)+"px");
        });
      svg.call(mainZoom);
      autoZoom(svg, proj, path, false);
      document.getElementById("zoom-controls").style.display = "flex";
    }
  }

  if (interactive && projName === "orthographic") addGlobeDrag(svg, proj, g);
  return { proj, path };
}

/* Merge cities with same coords into one (cumulate events) */
function mergeCities(cities) {
  const map = {};
  for (const c of cities) {
    const key = c.lat.toFixed(3)+","+c.lon.toFixed(3);
    if (!map[key]) map[key] = { ...c, events: [] };
    map[key].events.push({ year: c.year, title: c.title, detail: c.detail, resolvedNom: c._resolvedNom, resolvedLocal: c._resolvedLocal });
    /* always keep the most recent resolved name for the map label */
    map[key]._resolvedNom = c._resolvedNom;
    map[key]._resolvedLocal = c._resolvedLocal;
  }
  return Object.values(map);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RENDER MAIN MAP
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function renderMain(projName, animate) {
  const mapEl = document.getElementById("main-map");
  const doRender = () => {
    computeHighlighted();
    currentTransform = d3.zoomIdentity;
    buildMap(mapEl, projName, MW, MH, MPAD, true);
    document.getElementById("proj-info").textContent = PROJ_CONFIG[projName].desc;
    document.getElementById("globe-hint").classList.toggle("visible", projName === "orthographic");
    mapEl.classList.toggle("is-globe", projName === "orthographic");
    currentProj = projName;
    document.querySelectorAll(".proj-btn").forEach(b => b.classList.toggle("active", b.dataset.proj === projName));
    document.querySelectorAll(".gallery-card").forEach(c => c.classList.toggle("active", c.dataset.proj === projName));
  };
  if (animate) {
    d3.select(mapEl).transition().duration(180).style("opacity",0).end().then(() => {
      doRender();
      d3.select(mapEl).transition().duration(280).style("opacity",1);
    });
  } else { doRender(); mapEl.style.display="block"; mapEl.style.opacity="1"; }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   GALLERY
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function renderGallery() {
  const grid = document.getElementById("gallery");
  grid.innerHTML = "";
  Object.entries(PROJ_CONFIG).forEach(([key, cfg]) => {
    const card = document.createElement("div");
    card.className = "gallery-card" + (key === currentProj ? " active" : "");
    card.dataset.proj = key;
    const lbl = document.createElement("div");
    lbl.className = "gallery-label"; lbl.textContent = cfg.label;
    card.appendChild(lbl);
    const svgEl = document.createElementNS("http://www.w3.org/2000/svg","svg");
    svgEl.setAttribute("viewBox","0 0 "+GW+" "+GH);
    svgEl.setAttribute("preserveAspectRatio","xMidYMid meet");
    card.appendChild(svgEl);
    buildMap(svgEl, key, GW, GH, GPAD, false);
    card.addEventListener("click", () => renderMain(key, true));
    grid.appendChild(card);
  });
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TOOLTIP â€” countries
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function showTip(evt, d, type) {
  const p = getPays(d), id = cid(d), litEvts = highlightedMap[id];
  const era = getEra(getForm().timeline[currentDateIdx].year);
  document.getElementById("t-flag").textContent = p ? p.drapeau : "ðŸŒ";
  document.getElementById("t-name").textContent = p ? p.nom : "Territoire";
  document.getElementById("t-sub").textContent = era ? era.label : "";
  const body = document.getElementById("tip-body");
  body.innerHTML = "";
  if (litEvts && litEvts.length > 0) {
    let h = '<div class="tip-lit-section"><div class="tip-lit-label">'+getForm().label+'</div>';
    for (const ev of litEvts) {
      if (ev._inheritedFrom) continue; /* show inherited separately */
      const cityTag = ev.city ? '<span class="tip-city-badge">'+(resolveCityName(ev.city, ev.year).nom)+'</span>' : '';
      h += '<div class="tip-lit-event"><div class="tip-lit-year">'+formatYear(ev.year)+cityTag+'</div><div class="tip-lit-text">'+ev.title+'</div></div>';
    }
    /* inherited events (cultural continuity) */
    const inherited = litEvts._inherited;
    if (inherited && inherited.length > 0) {
      h += '<div class="tip-inherited"><div class="tip-inherited-label">HÃ©ritage culturel</div>';
      for (const ev of inherited) {
        const srcP = PAYS[ev._inheritedFrom];
        h += '<div class="tip-lit-event"><div class="tip-lit-year">'+formatYear(ev.year)+' <span style="opacity:.5">('+
          (srcP?srcP.nom:ev._inheritedFrom)+')</span></div><div class="tip-lit-text">'+ev.title+'</div></div>';
      }
      h += '</div>';
    }
    h += '</div>';
    body.innerHTML = h;
  } else if (p) {
    body.innerHTML = '<div class="tip-rows"><span class="tip-lbl">Capitale</span><span class="tip-val">'+p.capitale+'</span><span class="tip-lbl">Population</span><span class="tip-val">'+p.pop+'</span><span class="tip-lbl">Superficie</span><span class="tip-val">'+p.superficie+'</span></div>';
  }
  const tt = document.getElementById("tooltip");
  tt.classList.add("visible");
  positionTip(evt, tt);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TOOLTIP â€” cities
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function showCityTip(evt, c) {
  const p = PAYS[c.countryId];
  document.getElementById("t-flag").textContent = "ðŸ“";
  const displayName = c._resolvedNom + (c._resolvedLocal ? " ("+c._resolvedLocal+")" : "");
  document.getElementById("t-name").textContent = displayName;
  document.getElementById("t-sub").textContent = p ? p.nom : "";
  const body = document.getElementById("tip-body");
  let h = '<div class="tip-lit-section"><div class="tip-lit-label">'+getForm().label+' â€” '+c._resolvedNom+'</div>';
  for (const ev of c.events) {
    const evName = ev.resolvedNom && ev.resolvedNom !== c._resolvedNom ? ' <span style="opacity:.5">('+ev.resolvedNom+')</span>' : '';
    h += '<div class="tip-lit-event"><div class="tip-lit-year">'+formatYear(ev.year)+evName+'</div><div class="tip-lit-text">'+ev.title+'</div></div>';
  }
  h += '</div>';
  body.innerHTML = h;
  const tt = document.getElementById("tooltip");
  tt.classList.add("visible");
  positionTip(evt, tt);
}

function positionTip(evt, tt) {
  const m=16; let x=evt.clientX+m, y=evt.clientY+m;
  tt.style.left="0px"; tt.style.top="0px";
  const r=tt.getBoundingClientRect();
  if(x+r.width>window.innerWidth) x=evt.clientX-r.width-m;
  if(y+r.height>window.innerHeight) y=evt.clientY-r.height-m;
  tt.style.left=x+"px"; tt.style.top=y+"px";
}
document.addEventListener("mousemove", evt => { const tt=document.getElementById("tooltip"); if(tt.classList.contains("visible")) positionTip(evt,tt); });
function hideTip() { document.getElementById("tooltip").classList.remove("visible"); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   GLOBE DRAG (orthographic)
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function addGlobeDrag(svg, proj, g) {
  let ox=0, oy=0, r0;
  svg.call(d3.drag()
    .on("start", evt => { ox=evt.x; oy=evt.y; r0=proj.rotate().slice(); })
    .on("drag", evt => {
      proj.rotate([r0[0]+(evt.x-ox)*0.35, r0[1]-(evt.y-oy)*0.35]);
      const np = d3.geoPath().projection(proj);
      g.selectAll("path").attr("d", np);
      /* reproject cities */
      g.selectAll(".city-group").each(function() {
        const dot = d3.select(this).select("circle");
        const lbl = d3.select(this).select("text");
        const lon = +dot.attr("data-lon"), lat = +dot.attr("data-lat");
        if (!isNaN(lon) && !isNaN(lat)) {
          const pt = proj([lon, lat]);
          if (pt) {
            dot.attr("cx", pt[0]).attr("cy", pt[1]);
            lbl.attr("x", pt[0]).attr("y", pt[1]+8);
            const vis = d3.geoDistance([lon,lat],
              [-proj.rotate()[0], -proj.rotate()[1]]) < Math.PI/2;
            d3.select(this).style("display", vis ? null : "none");
          }
        }
      });
    })
  );
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TIMELINE
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function buildTimeline() {
  const form = getForm(), tl = form.timeline;
  const wrapper = document.getElementById("tl-track-wrapper");
  wrapper.querySelectorAll(".timeline-marker").forEach(m => m.remove());
  tl.forEach((entry, i) => {
    const pct = tl.length===1 ? 50 : (i/(tl.length-1))*100;
    const mk = document.createElement("div");
    mk.className = "timeline-marker"+(i===currentDateIdx?" active":"");
    mk.style.left = pct+"%"; mk.dataset.idx = i;
    const yr = document.createElement("div");
    yr.className = "timeline-marker-year"; yr.textContent = formatYear(entry.year);
    mk.appendChild(yr);
    mk.addEventListener("click", () => goToDate(i));
    wrapper.appendChild(mk);
  });
  updateTimelineUI();
}

function formatYear(y) {
  if (y < 0) return Math.abs(y) + " av. J.-C.";
  return String(y);
}

function updateTimelineUI() {
  const form = getForm(), tl = form.timeline;
  document.getElementById("timeline-year").textContent = formatYear(tl[currentDateIdx].year);
  const pct = tl.length===1 ? 50 : (currentDateIdx/(tl.length-1))*100;
  document.getElementById("tl-fill").style.width = pct+"%";
  document.querySelectorAll(".timeline-marker").forEach((mk,i) => mk.classList.toggle("active", i===currentDateIdx));
  document.getElementById("tl-prev").disabled = currentDateIdx===0;
  document.getElementById("tl-next").disabled = currentDateIdx===tl.length-1;
  renderEventCard();
}

function renderEventCard() {
  const entry = getForm().timeline[currentDateIdx];
  const inner = document.getElementById("event-card-inner");
  let h = '<div class="event-entries">';
  for (const evt of entry.events) {
    const p = PAYS[evt.countryId], flag = p ? p.drapeau : "ðŸŒ";
    const cityTag = evt.city ? (()=>{ const cn=resolveCityName(evt.city, entry.year); return '<span class="event-city-tag">ðŸ“ '+cn.nom+(cn.local?' ('+cn.local+')':'')+'</span>'; })() : '';
    h += '<div class="event-entry"><div class="event-flag">'+flag+'</div><div class="event-text"><div class="event-title">'+evt.title+cityTag+'</div><div class="event-detail">'+evt.detail+'</div></div></div>';
  }
  h += '</div>';
  inner.innerHTML = h;
}

function goToDate(idx) {
  const tl = getForm().timeline;
  if (idx<0 || idx>=tl.length) return;
  currentDateIdx = idx;
  updateTimelineUI();
  renderMain(currentProj, true);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FORM SWITCH
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function switchForm(formKey) {
  if (!LITERARY_FORMS[formKey]) return;
  currentForm = formKey; currentDateIdx = 0;
  document.querySelectorAll(".lit-btn").forEach(b => b.classList.toggle("active", b.dataset.form===formKey));
  document.getElementById("form-desc").textContent = getForm().desc;
  buildTimeline();
  renderMain(currentProj, true);
  renderGallery();
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ZOOM BUTTON HANDLERS
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function setupZoomButtons() {
  const svg = d3.select("#main-map");
  document.getElementById("z-in").addEventListener("click", () => {
    if (mainZoom) svg.transition().duration(300).call(mainZoom.scaleBy, 1.5);
  });
  document.getElementById("z-out").addEventListener("click", () => {
    if (mainZoom) svg.transition().duration(300).call(mainZoom.scaleBy, 0.67);
  });
  document.getElementById("z-reset").addEventListener("click", () => {
    if (mainZoom) svg.transition().duration(500).call(mainZoom.transform, d3.zoomIdentity);
  });
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SETUP UI
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function setupUI() {
  const litNav = document.getElementById("lit-nav");
  Object.entries(LITERARY_FORMS).forEach(([key, cfg]) => {
    const btn = document.createElement("button");
    btn.className = "lit-btn"+(key===currentForm?" active":"");
    btn.dataset.form = key; btn.textContent = cfg.label;
    btn.addEventListener("click", () => switchForm(key));
    litNav.appendChild(btn);
  });
  const projNav = document.getElementById("proj-nav");
  Object.entries(PROJ_CONFIG).forEach(([key, cfg]) => {
    const btn = document.createElement("button");
    btn.className = "proj-btn"+(key===currentProj?" active":"");
    btn.dataset.proj = key; btn.textContent = cfg.label;
    btn.addEventListener("click", () => renderMain(key, true));
    projNav.appendChild(btn);
  });
  document.getElementById("tl-prev").addEventListener("click", () => goToDate(currentDateIdx-1));
  document.getElementById("tl-next").addEventListener("click", () => goToDate(currentDateIdx+1));
  setupZoomButtons();
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   INIT
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function init() {
  try {
    const world = await d3.json("https://cdn.jsdelivr.net/npm/world-atlas@2/countries-110m.json");
    COUNTRIES = topojson.feature(world, world.objects.countries).features;
    document.getElementById("loading").style.display = "none";
    document.getElementById("form-desc").textContent = getForm().desc;
    setupUI(); buildTimeline(); renderMain("naturalEarth1", false); renderGallery();
  } catch(err) {
    document.getElementById("loading").innerHTML = '<div style="color:#c07a50;font-family:Cinzel,serif;font-size:.78rem;letter-spacing:.15em;text-transform:uppercase;text-align:center;padding:20px">Erreur de chargement<br><span style="font-family:EB Garamond,serif;font-style:italic;font-size:1rem;letter-spacing:0;text-transform:none;color:#7a6e5f;margin-top:8px;display:block">VÃ©rifiez votre connexion internet et rechargez la page.</span></div>';
    console.error(err);
  }
}
init();
</script>
</body>
</html>
